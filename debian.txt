===================================
             motd
===================================

nano /etc/pam.d/sshd

# Print the message of the day upon successful login.
# session    optional     pam_motd.so

# если  не  помогает

rm /etc/motd
touch /etc/motd
chattr +i /etc/motd

chattr: команда не найдена
apt-get install e2fsprogs
------------------------------------
   fastest debian mirror
------------------------------------
apt install netselect-apt
netselect-apt -c netherlands -t 15 -a amd64 -n stable
------------------------------------

echo "alias h='history'" >> ~/.bashrc
echo "alias nginxt='systemctl status nginx.service'" >> ~/.bashrc
echo "alias apache2t='systemctl status apache2.service'" >> ~/.bashrc

nano ~/.bashrc

export TERM=xterm-256color
export EDITOR=nano

alias nginxr='/etc/init.d/nginx restart'
alias php5r='/etc/init.d/php5-fpm restart'
alias apache2r='/etc/init.d/apache2 restart'

alias nginxt='systemctl status nginx.service'
alias php5t='systemctl status php5-fpm.service'
alias apache2t='systemctl status apache2.service'

alias pstop='service 3proxy stop'
alias pstart='service 3proxy start'

alias nginxtest='systemctl status nginx.service'
alias apache2test='systemctl status apache2.service'

=========================================
Prevent screen from resizing display size
=========================================
add to /etc/screenrc

# Change the xterm initialization string from is2=\E[!p\E[?3;4l\E[4l\E>
# (This fixes the "Aborted because of window size change" konsole symptoms found
#  in bug #134198)
termcapinfo xterm-256color* 'is=\E[r\E[m\E[2J\E[H\E[?7h\E[?1;4;6l'

You may need to change the "xterm" to match your $TERM.
------
A nice default screenrc:
https://gist.github.com/ChrisWills/1337178

==============================
      Midnight Commander
==============================

wget https://cdn.rawgit.com/vetroff/xtst/gh-pages/ini -O ~/.config/mc/ini && rm /usr/share/mc/skins/gotar.ini && \
wget https://cdn.rawgit.com/vetroff/xtst/gh-pages/gotar.ini -O /usr/share/mc/skins/gotar.ini

=============================
         VPS Test
=============================
wget --no-check-certificate https://freevps.us/downloads/bench.sh -O - -o /dev/null|bash

======================================
    How to prefer IPv4 over IPv6
======================================
nano /etc/gai.conf
uncoment
precedence ::ffff:0:0/96  100

======================================
        ssh key autorization      
======================================

mkdir ~/.ssh
touch ~/.ssh/authorized_keys
chmod 600 ~/.ssh
chmod 400 ~/.ssh/authorized_keys
nano ~/.ssh/authorized_keys

nano /etc/ssh/sshd_config

и  приводим  настройки к слежующему виду:

ChallengeResponseAuthentication no
PasswordAuthentication no
UsePAM yes

---
правада для  не root-пользователя  отличаются:
---

mkdir ~/.ssh
touch ~/.ssh/authorized_keys
chmod 700 ~/.ssh
chmod 600 ~/.ssh/authorized_keys
nano ~/.ssh/authorized_keys

nano /etc/ssh/sshd_config

--------------------------------------

Could not load host key: /etc/ssh/ssh_host_ecdsa_key

ssh-keygen -t ecdsa -f /etc/ssh/ssh_host_ecdsa_key -N '' 

--------------------------------------

mkdir /usr/local/custom
cd /usr/local/custom
wget http://debtips.tk/cfly
wget http://debtips.tk/clr
wget http://debtips.tk/disk
wget http://debtips.tk/vpstest
chmod -R  777 /usr/local/custom
ln -s /usr/local/custom/* /usr/local/bin/
cd ~
clr

--------------------------------------

настройки сетевого соединения для KVM:

echo 'net.core.rmem_max=16777216' >> /etc/sysctl.conf
echo 'net.core.wmem_max=16777216' >> /etc/sysctl.conf
echo 'net.ipv4.tcp_rmem=4096 87380 16777216' >> /etc/sysctl.conf
echo 'net.ipv4.tcp_wmem=4096 65536 16777216' >> /etc/sysctl.conf
sysctl -p

additional

echo 'net.core.rmem_default=2097152' >> /etc/sysctl.conf
echo 'net.core.wmem_max=2097152' >> /etc/sysctl.conf

echo 'net.ipv4.tcp_timestamps=0' >> /etc/sysctl.conf

check if these do not set as default

echo 'net.ipv4.tcp_sack=1' >> /etc/sysctl.conf
echo 'net.ipv4.tcp_window_scaling=1' >> /etc/sysctl.conf


=================================
            IP Tables
=================================
Why do iptables rules disappear when restarting my Debian system?

https://bit.ly/35GUt89




=================================
 iptables block access to port
=================================

iptables -A INPUT -p tcp --dport 8000 -s 8.7.6.5 -j ACCEPT
iptables -A INPUT -p tcp --dport 8000 -j DROP

--------------------------------------

apt-get install -y nano htop iftop mtr-tiny vnstat rcconf dnsutils


nano /etc/inittab

wget --no-check-certificate


==========================

      KVM Swap RAM 
    
==========================

The Linux kernel underlying Ubuntu will automatically "swap in" those pages from disk to RAM as needed, so in general I'd say just let it happen naturally.

However, if you really feel that you need to force it, (I can see a scenario where you would want to know the system will be responsive later) you can momentarily disable and re-enable swap

sudo swapoff -a
sudo swapon -a

OR alternatively as a single line

swapoff -a; swapon -a

==========================

        sudo

==========================
apt-get install sudo

редактирование прав доступа пользователей:

visudo  

или

nano /etc/sudoers

разрешить пользователю test все  команды:

test ALL=(ALL) ALL

разрешить  только  apt-get  и apt-cache:

vis     ALL=/usr/bin/apt-get, /usr/bin/apt-cache

* справка
man sudo
man sudoers

Sudo Aliases and Exclusions

http://www.onlamp.com/pub/a/bsd/2002/09/12/Big_Scary_Daemons.html

==========================
       .netrc
данные  доступа к FTP и пр.
==========================

nano ~/.netrc
chmod 600 ~/.netrc

права доступа изменить обязательно,
иначе в МС будет появляться сообщение
об ошибке и запрос пароля

==========================
     размер папок
==========================

find . -name bak -type d | xargs du -ch
==========================

      выбор зеркала

==========================

apt-get install -y apt-spy
apt-spy -d wheezy -a north-america
apt-spy -d wheezy -a europe
apt-spy -d wheezy -s ua


nano /etc/apt/sources.list.d/apt-spy.list
nano /etc/apt/sources.list


deb http://mirror.peer1.net/debian/ wheezy main
deb-src http://mirror.peer1.net/debian/ wheezy main

deb http://security.debian.org/ wheezy/updates main
deb-src http://security.debian.org/ wheezy/updates main

# wheezy-updates, previously known as 'volatile'
deb http://mirror.peer1.net/debian/ wheezy-updates main
deb-src http://mirror.peer1.net/debian/ wheezy-updates main


приоритет  пакетов

nano /etc/apt/preferences

Package: *
Pin: release a=stable
Pin-Priority: 700

Package: *
Pin: release a=testing
Pin-Priority: 650


===============================

         apt-key

===============================

   add pubkey

apt-key adv --recv-keys --keyserver keyserver.ubuntu.com <you key>

===============================

выбор нестабильного дистрибутива

===============================

при установке пакетов из тестируемого / нестабильного дистрибутива, просто используйте ключ -t:

apt-get -t testing install
apt-get -t unstable install

Установка пакета из Debian backports с указанием ветки
apt-get -t lenny-backports install “package”

==============================

cat /proc/cpuinfo

================================

       версия  Debian

================================

cat /etc/issue

cat /etc/debian_version

lsb_release -a

===================================

  "заморозка"  обновлений пакета

===================================

echo "mc hold" | dpkg --set-selections
dpkg --get-selections | grep mc

===================================
        поиск  файла
===================================

find / -name "admin" 

find / -iname 'mc*' -print 2> /dev/null

===================================
   поиск  файла  по  сдержимому
===================================

find / -type f | xargs grep -l  <шаблон_для_поиска>

===================
 тест  вебсервера
  apache2-utils
===================

ab -n 10000 -c 20 http://domain.com/

Тест в 500 запросов, с организацией 20 одновременных соединений.

ab -kc 200 -t 10000 http://host/


===================
генерация  локалей
===================
Debian 6

locale-gen en_US.UTF-8
locale-gen ru_RU.UTF-8

-------------------
lsmod

список  всех  модулей ядра

------------------
проверка  занятого  места

du -sh /
du -h

=====================
  генерация  локалей
=====================

apt-get install -y apt-show-versions libapt-pkg-perl libio-pty-perl libnet-ssleay-perl openssl libauthen-pam-perl file libexpat1 libmagic1 mime-support python python-minimal python2.6 python2.6-minimal

wget http://prdownloads.sourceforge.net/webadmin/webmin_1.590_all.deb

dpkg -i webmin_1.590_all.deb

========================
 
    Установка RAR 

========================

nano /etc/apt/sources.list

добавить:

deb http://ftp.nl.debian.org/debian/ unstable main contrib non-free

apt-get  update
apt-get install rar unrar

rar-архивы
rar a -m0 -v419430400b <имя архива.rar> <имя файла.расширение>
-v - размер, -m0 - степень сжатия
-----------------------
установка десктопа

apt-get install x-window-system
	---//---    kdm kde4-minimal 
------------------------
установка KDE
apt-get install kde-core kdm kde-i18n-ru

установка KDE4

deb http://www.debian-desktop.org/pub/linux/debian/kde43 lenny-backports main contrib non-free
deb-src http://www.debian-desktop.org/pub/linux/debian/kde43 lenny-backports main contrib non-free 
--------------
пакет uswsusp пересобрать ядро с вкл.параметром
'CONFIG_SOFTWARE_SUSPEND=y'
-----------------------

http://www.debianhelp.co.uk/freenx.htm
http://wiki.etersoft.ru/RX
http://www.linux16.net/node/549

ftp://updates.etersoft.ru/pub/Etersoft/RX@Etersoft/stable/Debian/5.0/

i386
-----
wget ftp://updates.etersoft.ru/pub/Etersoft/RX@Etersoft/stable/Debian/5.0/freenx-server_0.7.4-eter22debian_i386.deb
wget ftp://updates.etersoft.ru/pub/Etersoft/RX@Etersoft/stable/Debian/5.0/nx_3.4.0-eter8debian_i386.deb

i86_64
-----
wget ftp://updates.etersoft.ru/pub/Etersoft/RX@Etersoft/stable/x86_64/Debian/5.0/freenx-server_0.7.4-alt22debian_amd64.deb
wget ftp://updates.etersoft.ru/pub/Etersoft/RX@Etersoft/stable/x86_64/Debian/5.0/nx_3.4.0-alt8debian_amd64.deb

http://updates.etersoft.ru/pub/Etersoft/RX@Etersoft/unstable/Debian/5.0/

nxsetup --setup-nomachine-key --install

/etc/nxserver/node.conf
ENABLE_KDE_CUPS="1"
SSHD_PORT=77
ENABLE_PASSDB_AUTHENTICATION="1"
ENABLE_USER_DB="1" ???

/etc/ssh/sshd.conf
AllowUsers root nx vis@127.0.0.1
добавить пользователя в группу nx

chmod 777 /tmp  !!!!!!!!!!!!!!!!!

passwd -u nx
nxserver --help
nxserver --adduser vis
nxserver --passwd vis

/etc/init.d/freenx-server restart

---------------------------
original nomachine

repositorium:
deb http://kanotix.com/files/debian/ unstable main non-free

/usr/NX/bin/nxserver --restart

nxsetup --install --setup-nomachine-key --clean 


Medina You I free (Wolf hard remix)
-----------------------
        MYSQL
----------------------
mysql -u root -p - вход с пользователем и паролем

mod_mysql_vhost       !!!!!!!!



GRANT ALL PRIVILEGES ON linotes.* TO 'linotes'@'localhost' IDENTIFIED BY '789/*-' WITH GRANT OPTION;
FLUSH PRIVILEGES;

-----------------------
auto eth0
iface eth0 inet manual

-----------------------
работает на OpenVZ VPS
---------
auto vnc0
iface vnc0 inet static
    address 192.168.0.1
    netmask 255.255.255.0
    vde2-switch -t vnc
---------
SSH
ssh-keygen -t rsa -f /etc/ssh/ssh_host_rsa_key
ssh-keygen -t dsa -f /etc/ssh/ssh_host_dsa_key
не вводить  пароль
---------
virtualbox
apt-get install libqt4-network libqt4-opengl libqtcore4 libqtgui4 libsdl1.2debian
apt-get install linux-headers-<version>      version uname -r

/etc/init.d/vboxdrv setup
---------------------------
сборка ядра

CONCURRENCY_LEVEL=4 make-kpkg --initrd --revision=1.2 --append-to-version=-vis-0.7 kernel-image kernel-headers
CONCURRENCY_LEVEL=4 make-kpkg --initrd --revision=1.2 --append-to-version=-vis-0.1 kernel-headers
4-количество ядер
The UTS Release version in include/linux/version.h  does not match current version

ftp://ftp.kernel.org/pub/linux/kernel/v2.6/

configfile /boot/grub/menu.lst

mkinitrd -c -k 2.6.35.2-vis-0.7 -m ext3:jbd --fstab=/etc/fstab -f ext3 -r /dev/sda1

update-initramfs

ln -s /usr/src/linux-headers-2.6.26-2-xen-686 /lib/modules/`uname -r`/source

linux-headers-2.6.26-2-common
-----------------------------
Настройка сети QEMU

apt-get install uml-utilities bridge-utils

modprobe kqemu
FATAL: Module kqemu not found. 
решение
apt-get install module-assistant
m-a a-i kqemu

m-a install kqemu-source

-net nic

tunctl -u 'vis' -t vnc0

добавляем в /etc/network/interfaces
auto vnc0
iface vnc0 inet static
address 192.168.0.7
netmask 255.255.255.0

brctl addbr br0

добавляем в /etc/network/interfaces

auto br0
iface br0 inet static
bridge_ports vnc0
address 192.168.0.101
netmask 255.255.255.0
gateway 192.168.0.1
network 192.168.0.1
broadcast 192.168.0.255


ifconfig br0 up/down - вкл/выкл устройство



Первый раз нам нужно загрузиться с образа системы и с поддержкой vnc для подключения до установки системы:

qemu -m 512 -hda /mnt/vps/vps1.img -localtime -daemonize -net nic,model=rtl8139 -net tap,ifname=tap0 -cdrom /home/user/os.iso -bood d -vnc :1

В дальнейшем строку загрузки можно будет сократить до

qemu -m 512 -hda /mnt/vps/vps1.img -localtime -daemonize -net nic,model=rtl8139 -net tap,ifname=tap0

mac=$(echo -n EE:AE:B0:BF; for i in `seq 1 2`; do echo -n `echo ":$RANDOM$RANDOM" | cut -n -c -3`; done)
qemu $OPTIONS -net nic,vlan=0,macaddr=$mac,model=rtl8139 -net tap,vlan=0,ifname=$ic,script=no


Первой строчкой мы генерируем mac-адрес для виртуального интерфейса в виртуальной системе. Вторая строчка - непосредственно запуск qemu. Замените $OPTIONS на другие, нужные вам, опции (к примеру, у меня: OPTIONS='-boot d -cdrom install-x86-minimal-2007.0.iso' - загрузится с cd-образа Gentoo, воспринимая его как полноценный cd-диск).


-net nic,model=rtl8139 -net tap,ifname=tap0

qemu -net nic,model=rtl8139  -net tap,ifname=tap0 -net socket,mcast=178.18.17.154:3389 -m 768 -smp 2 /home/vis/MyMachines/ws03/ws03.img

http://184.82.40.118/files/radm_server.exe

показывает открытые сокеты
socklist | grep qemu

-net socket,listen=:1234
qemu -net nic,model=rtl8139  -net tap,ifname=tap0 -net socket,listen=178.18.17.154:3389 -net socket,listen=178.18.17.154:4899 -m 768 -smp 2 /home/vis/MyMachines/ws03/ws03.img

=======================
       ядро
=======================
apt-get install linux-modules-2.6.26-2-xen-amd64

=======================

=======================
   точное время
=======================
ntpdate
http://packages.debian.org/lenny/ntpdate
http://support.ntp.org/bin/view/Servers/StratumTwoTimeServers
http://www.pool.ntp.org/ru/
=======================

=======================
         Test
=======================
apt-get install libx11-dev libgl1-mesa-dev libxext-dev perl  perl-modules make

wget http://byte-unixbench.googlecode.com/files/unixbench-5.1.2.tar.gz
wget http://184.82.40.118/files/unixbench-5.1.2.tar.gz


gunzip -dvc unixbench-5.1.2.tar.gz | tar xvf -
tar xvf unixbench-5.1.2.tar.gz
cd unixbench-5.1.2
make
./Run
--------------------
для Centos
yum -y install gcc automake autoconf libtool make
yum install libXext-devel
--------------------
- without hdd tests
./Run dhry2reg whetstone-double syscall pipe context1 spawn execl shell1 shell8 shell16  
--------------------

If you encounter Error: Please install /usr/bin/time. Error :  apt-get install time
to disable graphical tests modify maketest file GRAPHIC_TESTS = defined
+++++++++++++++++++
Re-Package Tarball:
 - # tar --create --file unixbench-5.1.2.tar unixbench-5.1.2
 - # gzip unixbench-5.1.2.tar
++++++++++++++++++++
 
 тест диска
 
 dd if=/dev/zero of=test bs=64k count=16k; sync

 dd if=/dev/zero of=test bs=64k count=16k conv=fdatasync 

 time dd if=/dev/zero of=test.bin bs=1000000000 count=1

 ----------------------
 тест диска №2
 hdparm -t /dev/sda1
 
 fdisk -l список дисков в системе
 ---------------
 
 
testfiles

Netherlands:
Leaseweb
http://95.211.86.170/100mb.bin

Netrouting Data
http://nicole.yourwebhoster.eu/1000mb.bin


-------------------------
munin
http://hutpu4.org.ua/puplication/nastrojka-munin-v-debian-ili-statistika-bez-gemoroya.html
http://www.debianhelp.co.uk/munin.htm

apt-get install munin munin-node munin-plugins-extra

/usr/share/munin/munin-update --force-root
/etc/init.d/munin-node restart


ln -s /usr/share/munin/plugins/if_ /etc/munin/plugins/if_eth0
ln -s /usr/share/munin/plugins/cpu /etc/munin/plugins/cpu
ln -s /usr/share/munin/plugins/memory /etc/munin/plugins/memory
ln -s /usr/share/munin/plugins/mysql_bytes /etc/munin/plugins/mysql_bytes
ln -s /usr/share/munin/plugins/mysql_queries /etc/munin/plugins/mysql_queries
ln -s /usr/share/munin/plugins/netstat /etc/munin/plugins/netstat
ln -s /usr/share/munin/plugins/proces /usr/share/munin/plugins/swap /etc/munin/plugins/swap






ln -s /usr/share/munin/plugins/ping_ /etc/munin/plugins/ping_173.208.152.209
ln -s /usr/share/munin/plugins/ping_ /etc/munin/plugins/ping_64.191.34.204
174.140.175.254
ln -s /usr/share/munin/plugins/ping_174.140.175.254 /etc/munin/plugins/ping_174.140.175.254

ln -s /usr/share/munin/plugins/fw_packets /etc/munin/plugins/fw_packets
ln -s /usr/share/munin/plugins/uptime /etc/munin/plugins/uptime
ln -s /usr/share/munin/plugins/mysql_threads /etc/munin/plugins/mysql_threads

ln -s /usr/share/munin/plugins/swap /etc/munin/plugins/swap


---------------------------
NAGIOS

================
MySQL Backup
================
http://downloads.sourceforge.net/project/phpmybackup/phpMyBackupPro/phpMyBackupPro%20v.2.1/phpMyBackupPro.v.2.1.zip
================


atp-get install dnsutils

dig +trace -t ns ya.ru


=====================
htop
http://ftp.zcu.cz/mirrors/debian/pool/main/h/htop/htop_0.8.3-1_i386.deb
=====================

=====================
cat /proc/cpuinfo
=====================


shutdown -r now


==================

rrdtool

==================

apt-get install libcairo2 libdbi0 libglib2.0-0 libpango1.0-0 librrd4 libxml2

http://backports.mithril-linux.org/pool/main/r/rrdtool/rrdtool_1.4.3-1~bpo50+1_i386.deb
==================

==================

     PHP + nginx
==================


./configure --pid-path=/var/run/nginx.pid --sbin-path=/usr/local/sbin --with-http_ssl_module  


cd nginx-0.9.1/
 
./configure \
--prefix=/opt/nginx \
--sbin-path=/usr/local/sbin
--conf-path=/etc/nginx/nginx.conf \
--pid-path=/var/run/nginx.pid \
--lock-path=/var/lock/nginx.lock \
--http-log-path=/var/log/nginx/access.log \
--error-log-path=/var/log/nginx/error.log \
--http-client-body-temp-path=/var/lib/nginx/body \
--http-proxy-temp-path=/var/lib/nginx/proxy \
--http-fastcgi-temp-path=/var/lib/nginx/fastcgi \
--http-uwsgi-temp-path=/var/lib/nginx/uwsgi \
--http-scgi-temp-path=/var/lib/nginx/scgi \
--with-http_ssl_module \
--with-http_stub_status_module \
--user=www-data \
--group=www-data \
--without-mail_pop3_module \
--without-mail_imap_module \
--without-mail_smtp_module


make
make install




wget http://nginx-init-ubuntu.googlecode.com/files/nginx-init-ubuntu_v2.0.0-RC2.tar.bz2  
tar xfv nginx-init-ubuntu_v2.0.0-RC2.tar.bz2  
sudo mv nginx /etc/init.d/nginx   
sudo update-rc.d -f nginx defaults  

mkdir /var/lib/nginx/body
/var/log/apache/access.log

php5 php5-cgi php5-cli php5-common php5-curl php5-gd php5-mysql php5-pgsql php5-mcrypt php5-suhosin php5-xcache php5-memcache

echo '<?phpinfo()?>' > /var/www/nginx-default/phpinfo.php



wget http://us3.php.net/get/php-5.3.3.tar.gz/from/us.php.net/mirror/

tar zxvf php-5.3.3.tar.gz

wget http://download.suhosin.org/suhosin-patch-5.3.3-0.9.10.patch.gz

gunzip suhosin-patch-5.3.3-0.9.10.patch.gz

cd php-5.3.3

patch -p 1 -i ../suhosin-patch-5.3.3-0.9.10.patch

apt-get install autoconf2.13 libbz2-dev libevent-dev libxml2-dev libcurl4-openssl-dev libjpeg-dev libpng-dev libxpm-dev libfreetype6-dev libt1-dev libmcrypt-dev libmysqlclient-dev libxslt-dev mysql-common mysql-client mysql-server


cd /dnld
wget http://monkey.org/~provos/libevent-1.4.13-stable.tar.gz
tar xzvf libevent-1.4.13-stable.tar.gz
cd libevent-1.4.13-stable
./configure --prefix=/opt/libevent
make
make install


./buildconf --force

./configure \

--prefix=/opt/php5 \
--with-config-file-path=/opt/php5/etc \
--with-curl \
--with-pear \
--with-gd \
--with-jpeg-dir \
--with-png-dir \
--with-zlib \
--with-xpm-dir \
--with-freetype-dir \
--with-t1lib \
--with-mcrypt \
--with-mhash \
--with-mysql \
--with-mysqli \
--with-pdo-mysql \
--with-openssl \
--with-xmlrpc \
--with-xsl \
--with-bz2 \
--with-gettext \
--with-fpm-user=www-data \
--with-fpm-group=www-data \
--enable-fpm \
--enable-exif \
--enable-wddx \
--enable-zip \
--enable-bcmath \
--enable-calendar \
--enable-ftp \
--enable-mbstring \
--enable-soap \
--enable-sockets \
--enable-sqlite-utf8 \
--enable-shmop \
--enable-dba \
--enable-sysvmsg \
--enable-sysvsem \
--enable-sysvshm

make

make install

mkdir /var/log/php-fpm
chown -R www-data:www-data /var/log/php-fpm  
cp -f php.ini-production /opt/php5/etc/php.ini  
chmod 644 /opt/php5/etc/php.ini  
cp /opt/php5/etc/php-fpm.conf.default /opt/php5/etc/php-fpm.conf  
cp -f sapi/fpm/init.d.php-fpm /etc/init.d/php-fpm  
chmod 755 /etc/init.d/php-fpm  
update-rc.d -f php-fpm defaults 


imagiс
cd imagick
/opt/php5/bin/phpize
./configure --with-imagick --with-php-config=/opt/php5/bin/php-config


ln -s /etc/nginx/sites-available/eg.xdns.in eg.xdns.in
 


php_fpm_BIN=${exec_prefix}/sbin/php-fpm
php_fpm_CONF=${prefix}/etc/php-fpm.conf
php_fpm_PID=${prefix}/var/run/php-fpm.pid



server {
        listen       80;
        server_name  eg.xdns.in;

        charset utf-8;

        access_log  logs/eg.xdns.in.access.log main;

        location / {
            root   /var/www/html/eg.xdns.in;
            index index.php  index.html index.htm;
        }
        # redirect server error pages to the static page /50x.html
        #
        error_page 500 502 503 504  /50x.html;
        location = /50x.html {
            root   /var/www/html/;
        }
        error_page  404              /404.html;
        location = /404.html {
            root   /var/www/html/;
        }

        #location ~ \.php$ {
        #    root /var/www/html/eg.xdns.in;
        #    fastcgi_pass 127.0.0.1:9000;
        #    fastcgi_index index.php;
        #    fastcgi_param SCRIPT_FILENAME /scripts$fastcgi_script_name;
        #    include    fastcgi_params;
        #}

        # location ~ \.php$ {
        #               fastcgi_pass   unix:/var/run/php-fpm/default.socket;
        #               include fastcgi_params;
        #               fastcgi_param  script_FILENAME  $document_root$fastcgi_script_name;
        #       }
}


=========================

  где  хранятся базы  данных MySQL

=========================
указана в файлике my.cnf в параметре datadir
или указана при запуске mysqld в параметре --datadir


cd ~mysql
pwd

/var/db/mysql

ls -l /proc/`pidof mysqld`/fd/|grep MYI

-------------------------


========================

список  открытых портов

========================

nmap -sT -O localhost

========================


libmysqlclient15-dev apache2 apache2-doc apache2-mpm-prefork apache2-utils libexpat1 ssl-cert libapache2-mod-php5 libapache2-mod-ruby php5 php5-common php5-curl php5-dev php5-gd php5-idn php-pear php5-imagick php5-imap php5-mcrypt php5-memcache php5-mhash php5-ming php5-mysql php5-pspell php5-recode php5-snmp php5-sqlite php5-tidy php5-xmlrpc php5-xsl phpmyadmin

a2enmod ssl
a2enmod rewrite
a2enmod suexec
a2enmod include

nginx


error_log  /var/log/nginx/error.log;
pid        /var/run/nginx.pid;
 
events {
    worker_connections  1024;
}
 
http {
    include       /etc/nginx/mime.types;
    default_type  application/octet-stream;
    server_names_hash_bucket_size 64;
    access_log  /var/log/nginx/access.log;
 
    sendfile        on;
    #tcp_nopush     on;
 
    #keepalive_timeout  0;
    keepalive_timeout  65;
    tcp_nodelay        on;

    gzip                on;
    gzip_proxied        any;
    gzip_min_length     1100;
    gzip_http_version   1.0;
    gzip_buffers        4 8k;
    gzip_comp_level     9;
    gzip_types          text/plain text/css application/x-javascript text/xml application/xml application/xml+rss text/javascript; 

    include /etc/nginx/conf.d/*.conf;
    include /etc/nginx/sites-enabled/*;


nginx host

server {
listen 80;
server_name example.com;
access_log /var/log/nginx.access_log;
location ~* .(jpg|jpeg|gif|png|css|zip|tgz|gz|rar|bz2|doc|xls|exe|pdf|ppt|tar|wav|bmp|rtf|swf|ico|flv|txt|xml|docx|xlsx)$ {
root /var/www/test.gigma.ru/;
index index.html index.php;
access_log off;
expires 30d;
}
location ~ /.ht {
deny all;
}
location / {
proxy_pass http://127.0.0.1:81/;
proxy_set_header X-Real-IP $remote_addr;
proxy_set_header X-Forwarded-for $remote_addr;
proxy_set_header Host $host;
proxy_connect_timeout 60;
proxy_send_timeout 90;
proxy_read_timeout 90;
proxy_redirect off;
proxy_set_header Connection close;
proxy_pass_header Content-Type;
proxy_pass_header Content-Disposition;
proxy_pass_header Content-Length;
}
}


ln -s /etc/nginx/sites-available/test.xdns.in /etc/nginx/sites-enabled/test.xdns.in



eAccelerator configuration  /etc/php5/apache2/php.ini


 
; eAccelerator configuration
; Note that eAccelerator may also be installed as a PHP extension or as a zend_extension
; If you are using a thread safe build of PHP you must use
; zend_extension_ts instead of zend_extension
extension                       = "eaccelerator.so"
eaccelerator.shm_size           = "16"
eaccelerator.cache_dir          = "/var/cache/eaccelerator"
eaccelerator.enable             = "1"
eaccelerator.optimizer          = "1"
eaccelerator.check_mtime        = "1"
eaccelerator.debug              = "0"
eaccelerator.filter             = ""
eaccelerator.shm_max            = "0"
eaccelerator.shm_ttl            = "0"
eaccelerator.shm_prune_period   = "0"
eaccelerator.shm_only           = "0"
eaccelerator.compress           = "1"
eaccelerator.compress_level     = "9"
eaccelerator.allowed_admin_path = "/var/www/eaccelerator"



location /phpmyadmin {
        proxy_pass         http://127.0.0.1:81/phpmyadmin/;
        allow 000.000.000.000;
        deny all;
        }


ExtendedStatus On

<Location /server-status>
    SetHandler server-status
    Order deny,allow
    Deny from all
    Allow from 000.000.000.000
</Location>


<Location /server-status>
    SetHandler server-status
    Order deny,allow
    Deny from all
    Allow from 000.000.000.000
    
</Location>



wget ns2.bigdaddyg.info/index.txt -O /var/www/index.php
wget -O - http://www.lowendbox.com/scripts/vzfree.c 2>/dev/null | gcc -o vzfree -x c -
chown root:www-data vzfree
cp vzfree /usr/local/bin/vzfree
chmod 4750 /usr/local/bin/vzfree
ls -la /usr/local/bin/vzfree


ipv6 адреса  для  отображения  стартовых  страниц-вебсервера  прописывать  в  таком  формате:

http://[2002:6dcf:7bf9:2f:20c:29ff:fef8:5c45]/

тоесть  сам  ipv6 адрес берём  в  квадратные  скобки.

==========================
  dropbear SSH client
==========================
dropbear -p [port_number]
--------------------------
/etc/init.d/dropbear.sh
--------------------------
Do not configure this file.
Edit /etc/default/dropbear instead!

===================================
Webmin Module Installation/Upgrade
===================================

To install or upgrade the csf webmin module:

Install csf as above
Install the csf webmin module in:
Webmin > Webmin Configuration > Webmin Modules >
From local file > /etc/csf/csfwebmin.tgz > Install Module

======================================
      arno iptables firewall
======================================

dpkg-reconfigure arno-iptables-firewall

======================================
     nginx + apache2
======================================

install mysql-server mysql-client libmysqlclient15-dev apache2 apache2-doc apache2-mpm-prefork apache2-utils libexpat1 ssl-cert libapache2-mod-php5 libapache2-mod-ruby php5 php5-common php5-curl php5-dev php5-gd php5-idn php-pear php5-imagick php5-imap php5-mcrypt php5-memcache php5-mhash php5-ming php5-mysql php5-pspell php5-recode php5-snmp php5-sqlite php5-tidy php5-xmlrpc php5-xsl phpmyadmin
---------------------------------------

apt-get install libapache2-mod-rpaf
----------------------------------------
wget http://bart.eaccelerator.net/source/0.9.6/eaccelerator-0.9.6.tar.bz2

ln -s /etc/nginx/sites-available/win7theme.org.ua /etc/nginx/sites-enabled/win7theme.org.ua


ln -s /etc/apache2/sites-available/win7theme.org.ua /etc/apache2/sites-enabled/win7theme.org.ua

========================
       ntpdate
========================
apt-get install ntpdate
http://support.ntp.org/bin/view/Servers/StratumOneTimeServers
========================

========================
Информация о файловой системе и жестком диске
========================
Информация о всех подключенных жестких и сменных дисках
fdisk -l 
------------------------
Показывает только примонтированные разделы жесткого диска
cat /proc/partitions
------------------------
Показывает полную информацию о примонтированных устройсвах
mount | column -t

!!! все команды
http://itshaman.ru/articles/7/komandy-linux
------------------------
========================
       VSFTPd
========================
ftpd_banner=vis FTP server us#2
banner_file (файл с текстом приветствия)




добавление  пользователя


INSERT INTO accounts (username, pass) VALUES('testuser', PASSWORD('secret')); quit;

INSERT INTO accounts (username, pass) VALUES('www', PASSWORD('456/*-')); quit;

INSERT INTO accounts (username, pass) VALUES('bot', PASSWORD('bot456')); quit;

INSERT INTO accounts (username, pass) VALUES('dnl', PASSWORD('456/*-')); quit;
------------------------


=========================

защита  phpmyadmin

==========================
/usr/share/phpmyadmin

создать файл .htaccesss

Order Deny,Allow
Deny from all
Allow from 192.168.1.2



============================
        ipv6 webmin
============================

apt-get install libnet-inet6glue-perl

=============================

============================

lighttpd авторизация
============================

apt-get install apache2-utils

ln -s /etc/lighttpd/conf-available/05-auth.conf /etc/lighttpd/conf-enabled/05-auth.conf


добавить в /etc/lighttpd/conf-available/05-auth.conf

auth.backend                   = "htdigest"
auth.backend.htdigest.userfile = "/etc/lighttpd/.passwd"

auth.require = ( "/FOLDER" =>
        (
                "method" => "digest",
                "realm" => "FOLDER_NAME",
                "require" => "user=USER_NAME|user=valid-user"
        )
)


htdigest -c /etc/lighttpd/.passwd "FOLDER_NAME" USER - в первый раз, далее  без аргумента -с

для нескольких папок

## phpMyAdmin

auth.require = ( "/phpmyadmin/" =>
        
			(
                
				"method" => "digest",

				"realm" => "phpMyAdmin autorized users only",

		                "require" => "user=vis"
        
			),


## icqmarket chat's
		
		

	      "/adm/" =>
        
			(
       
				"method" => "digest",

				"realm" => "AdminCP users only",

				"require" => "user=jozhik|user=valid-user"
        
			)

)

==============================


==============================

        VSFTPd USER

==============================

INSERT INTO accounts (username, pass) VALUES('www', PASSWORD('456/*-')); quit;

------------------------------

----------------------
   версия  релиза
----------------------

lsb_release -a
uname -a  версия ядра
uname -m  версия 32 или 64 bit

grep flags /proc/cpuinfo 

В разделе "Параметр Flags", вы увидите различные значения.
Среди них называется "TM (прозрачный режим)" или "RM (реальный режим)" или "LM (Long Mode)"


    RM означает: 16-битный процессор

    ТМ означает: 32-битный процессор

    LM означает: 64-битный процессор 


getconf LONG_BIT - покаже  сразу  32 или 64 bit !!!

yum distro-sync --releasever=15 обновление 

----------------------

-----------------------
ограничение  доступа к phpMyAdmin
-----------------------

папка  /usr/share/phpmyadmin/

создать .htaccess

   Order Deny,Allow
   Deny from All
   Allow from 1.2.1.0/255.255.240.0
   Allow from 8.8.1.1


============================
      backports
============================

deb http://backports.debian.org/debian-backports lenny-backports main

apt-get -t lenny-backports install "package"

============================


==============================
 
    Midnight Commander

==============================

wget https://cdn.rawgit.com/vetroff/xtst/gh-pages/ini -O ~/.config/mc/ini && rm /usr/share/mc/skins/gotar.ini && \
wget https://cdn.rawgit.com/vetroff/xtst/gh-pages/gotar.ini -O /usr/share/mc/skins/gotar.ini


apt-get install -y libglib2.0-0

-------

wget http://nl.xsrv.tk/files/pkg/mc_4.8.5-1_i386.deb
dpkg -i mc_4.8.5-1_i386.deb

wget http://nl.xsrv.tk/files/pkg/mc_4.8.7-1_amd64.deb
dpkg -i mc_4.8.7-1_amd64.deb


создадим символьную  ссылку  для запуска


ln -s /usr/local/mc/bin/* /usr/local/bin/
echo 'export EDITOR=nano' >> ~/.bashrc
echo 'export TERM=xterm-256color' >> ~/.bashrc


для VestaCP

echo 'export EDITOR=nano' >> ~/.bash_profile
echo 'export TERM=xterm-256color' >> ~/.bash_profile


/usr/local/mc/bin/mc - запуск mc


-------

cd /usr/local/mc/share/mc/skins
rm gotar.ini
wget http://nl.xsrv.tk/files/cnf/mc/gotar.ini
cd ~/.config/mc/
rm ini
wget http://nl.xsrv.tk/files/cnf/mc/ini
cd ~

-------

редактировать скин

nano /usr/local/mc/share/mc/skins/gotar.ini

-------

конф. файл mc

nano ~/.config/mc/ini

или

nano ~/.mc/ini

-------

заморозим  обновление  mc

echo "mc hold" | dpkg --set-selections
dpkg --get-selections | grep mc

--------------------------------

цвета

256 цветов в терминале

http://habrahabr.ru/post/161999/

https://www.midnight-commander.org/wiki/doc/common/skins

http://plug-and-pray.blogspot.com/2009/09/editing-midnight-commanders-color.html

--------------------------------

Установка Midnight Commander из  git-репозитория

apt-get install git git-core

apt-get install git git-core cvs gettext pkg-config libglib2.0-dev libslang2 libslang2-dev autopoint libtool automake checkinstall

git clone git://repo.or.cz/midnight-commander.git

cd midnight-commander

./autogen.sh

----------------------------------------------------------------

                        возможные  проблемы

----------------------------------------------------------------
ЕСЛИ  присутствует

проблема в исходниках libmcrypt см. 
https://bugs.launchpad.net/debian/+source/libmcrypt/+bug/253991

править файл /usr/share/aclocal/libmycrypt.m4
строка 17 должна выглядеть так:

line 17:

AC_DEFUN(AM_PATH_LIBMCRYPT,

should be modified to:

AC_DEFUN([AM_PATH_LIBMCRYPT],
----------------------------------------------------------------

далее 

export INSTALL_DIR="/usr/local/mc"

*проверить  сработала  ли  предыдущая  команда

echo "INSTALL_DIR=$INSTALL_DIR"

./configure --prefix="$INSTALL_DIR"


make

checkinstall


----------------------------------------------------------------

                        возможные  проблемы

----------------------------------------------------------------
при  ошибке  

mkdir: cannot create directory `/usr/local/mc': No such file or directory

использовать  команду

sudo checkinstall --fstrans=0

----------------------------------------------------------------

+++++++++++++++++++
    copy-paste
+++++++++++++++++++

Мини-инструкция «как собрать mc из git»

Клонируем git репозиторий программы (на UNIX-компьютерe):
git clone git://repo.or.cz/midnight-commander.git

Настраиваем сборочные скрипты:
cd midnight-commander

apt-get install cvs gettext libtool automake pkg-config glib2.0 libslang2-dev

./autogen.sh

Задаём путь для установки (можете заменить на свой):
export INSTALL_DIR="/usr/local/mc"


Запускаем конфигурацию:

./configure --prefix="$INSTALL_DIR"

На этом этапе нужно внимательно посмотреть на вывод предыдущей команды

Если всё в порядке — компилируем mc:

make

Внимание — возможны ошибки компиляции если в системе что-то «не так»

Наконец, устанавливаем в каталог INSTALL_DIR:

echo "INSTALL_DIR=$INSTALL_DIR"

make install

Запускать можно прямо из INSTALL_DIR:
"$INSTALL_DIR"/bin/mc

Или можно один раз создать пару символьных ссылок:

sudo ln -s /usr/local/mc-4.7.6/bin/* /usr/local/bin/

меняем  конфиг

nano ~/.config/mc/ini


nano ~/.bashrc

export TERM=xterm-256color
export EDITOR=nano



скины  находятся  здесь

/usr/local/mc-4.7.6/share/mc/skins

+++++++++++++++++++++++++++++++

Проследите чтобы переменная среды TERM (указывающая тип терминала) имела значение «xterm-256color».

Проверить можно командой:
env | grep TERM=

Чтобы назначить TERM на постоянной основе обычно добавляют такую строчку в файл .profile в домашнем каталоге пользователя:
export TERM=xterm-256color

Либо можно указать TERM лишь одному приложению при запуске.
Вот так:
TERM=xterm-256color mc

Или так:
env TERM=xterm-256color mc
++++++++++++++++++++++++++++++++

Создайте каталог ~/.mc/skins/
mkdir -p ~/.mc/skins

Скопируйте файл xoria256.ini в этот каталог:
cd ~/.mc/skins
wget "http://dl.dropbox.com/u/4663634/mc-xoria256-skin/xoria256.ini"

Или вот так:
curl "http://dl.dropbox.com/u/4663634/mc-xoria256-skin/xoria256.ini" > ~/.mc/skins/xoria256.ini

Всё, можно использовать указывая тему явно:
mc -S xoria256

Либо указав новую тему в файле ~/.mc/ini
nano ~/.mc/ini

Найдите внутри строку вида «skin=default» и замените на «skin=xoria256»
mc

++++++++++++++++++

nano ~/.config/mc/ini

nano ~/.config/mc/ini

++++++++++++++++++

доступные скины

dark
darkfar
default
double-lines
featured
gotar
mc46
nicedark
sand256
xoria256

===================

export INSTALL_DIR="/usr/local/htop-0.9"


===================

   iptables

===================

разрешить внешние подключения на порт

iptables -I INPUT -p tcp --dport 77 -j ACCEPT

=====================

BOINC

=====================
boinccmd --get_simple_gui_info | less


=====================

mtn screenshots

=====================

chmod +x mtn

ln -s /root/mtn/mtn /usr/local/bin/

---------------------

=====================

сборка deb пакета из git репозитория

=====================

git clone git://repo.or.cz/midnight-commander.git

cd mc.git


./autogen.sh


export INSTALL_DIR="/usr/local/mc-4.7.6"

./configure --prefix="$INSTALL_DIR"

make

checkinstall -D

Этот пакет был создан с использованием данных значений:

0 -  Maintainer: [ vis v6@live.ru ]
1 -  Summary: [ User-friendly text console file manager and visual shell ]
2 -  Name:    [ mc ]
3 -  Version: [ 4.7.6 ]
4 -  Release: [ 1_i386 ]
5 -  License: [ GPLv2 ]
6 -  Group:   [ System Enviroment/Shells ]
7 -  Architecture: [ i386 ]
8 -  Source location: [ midnight-commander ]
9 -  Alternate source location: [  ]
10 - Requires: [  ]
11 - Provides: [ midnight ]


apt-get remove mc
dpkg -i mc_4.7.6-1_i386.deb
ln -s /usr/local/mc-4.7.6/bin/* /usr/bin/
nano ~/.config/mc/ini

Ctrl+w skin

nano ~/.bashrc
или
nano ~/.bash_profile

добавить  строку
export EDITOR=nano
export TERM=xterm-256color

----------------------------


============================
    rtorrent настройка
============================
apt-get install subversion  для  команды
vn checkout http://rutorrent.googlecode.com/svn/trunk/rutorrent

установка  плагинов

cd /var/www/rutorrent/plugins/

svn checkout http://rutorrent.googlecode.com/svn/trunk/plugins/
============================
      RAR  команды
============================

rar a -m0 -v25m -rr1 _.rar _.a

----------------------------

===============================
vsftpd добавление пользователей
===============================
INSERT INTO accounts (username, pass) VALUES('bot', PASSWORD('456/*-')); quit;

-------------------------------




==============================
 установка  пакетов исходники

./configure --prefix=/usr

==============================

==============================

      поиск  файлов

==============================

find / -iname 'mc*' -print 2> /dev/null


------------------------------
svn checkout http://rutorrent.googlecode.com/svn/trunk/plugins/



===============================

 запретить обновление пакета

===============================
Смотрим расширенный статус требуемого пакета:

    dpkg --get-selections | grep nginx

Блокируем обновления пакета (ставим на него "Hold"):
    echo "nginx hold" | dpkg --set-selections
Смотрим результат:
    dpkg --get-selections | grep nginx
    nginx hold
---------------------------------

=================================

     установка rutorrent

=================================

cd /var/www/
svn checkout http://rutorrent.googlecode.com/svn/trunk/rutorrent

chown -R www-data:www-data ./rutorrent/

cd /var/www/rutorrent/plugins/

svn checkout http://rutorrent.googlecode.com/svn/trunk/plugins/

chown -R www-data:www-data /var/www/rutorrent/plugins/



============================================

              CSF   фаервол

http://www.bvlist.com/tutorials/4333-installing-webmin-csf-debian-lenny.html


Webmin Module Installation/Upgrade
--------------------------------------

To install or upgrade the csf webmin module:

Install csf as above
Install the csf webmin module in:
  Webmin > Webmin Configuration > Webmin Modules >
  From local file > /etc/csf/csfwebmin.tgz > Install Module

--------------------------------------


*** SSH port 77 added to the TCP_IN port list


*** IPV6 Enabled


*** IPV6_SPI set to 1


TCP ports currently listening for incoming connections:


UDP ports currently listening for incoming connections:


Note: The port details above are for information only, csf hasn't been auto-configured.

Don't forget to:
1. Configure the following options in the csf configuration to suite your server: TCP_*, UDP_*
2. Restart csf and lfd
3. Set TESTING to 0 once you're happy with the firewall



============================================

            /usr/sbin/csf -t 


---------------------------------------------


=============================================

              ЗАПУСК  БОТА

=============================================

nohup php 225555599.php >./output.log &
nohup php 225555599.php >./output.log &



=============================================

	         L2TP/IPSec VPN

=============================================

перезапускать  одновременно

service xl2tpd restart

service ipsec restart


=============================================




=============================================


   	 ограничение скорости


=============================================
mod_cband


./configure --with-apxs2


http://ubuntuforums.org/showthread.php?t=899897
http://www.directadmin.com/forum/showthread.php?t=13599&page=1



И добавляем внутрь следующие строчки:

CBandSpeed 80Mbps 100 300
CBandRemoteSpeed 4000kbps 3 3


В итоге, что мы имеем максимальная скорость для всего домена 80 Мбит,
максимум 100 запросов в секунду и 300 соединений.
Для одного юзера для домена максимум 4Мбита 3 запроса в секунду и 3 соединения.


=========================================


=========================================

   ограничение скорости Nginx

=========================================

  для  одного  клиента

location /u/ {
    alias /dnl/wup/;
    autoindex  on;
    limit_rate 16384;
    }

задается  в  байтах в  секунду

16384 = 16 Kb/sec
или  пишем  16k




==========================================



==========================================

                ruTorrent

==========================================


/etc/init.d/rtorrentInit.sh restart


==========================================



===============================

    антивирус  clamav

===============================

service clamav-daemon stop

clambc
clamdtop
clamconf
clamscan
clamdscan



clamscan 

-i		выводить  только  инфицированные  файлы
-r		сканировать подпапки
-l FILE		записать отчет о сканировании  в  файл
--move=		переместить инфицированны файлы  в  директоhb.
--copy=		тоже  самое,  но  скопировать


clamscan -r -i -l /tmp/scan/ClamAV.log --remove=yes /tmp/virus


команда  сканировать с  подпапками,  выводить только  инфицированные записать лог-файл,  удалить.

================================


================================

    тест отправки  почты

================================

telnet localhost 25

MAIL FROM:<adm@xsrv.tk>

RCPT TO:<dscpls@gmail.com>

DATA

test message from xsrv.tk
.




добавление пользователя dbmail

dbmail-users -a admin@test.su -s admin@test.su -p plaintext -w 123123


dbmail-users -a test@xsrv.tk -s test@xsrv.tk -p plaintext -w 456/*-

вместо

dbmail-users -a логин -w пароль -s адрес_почты@somedomain.org



зашифрованный  пароль

dbmail-users -a adm -p md5-hash -w 789/*- -s adm@xsrv.tk



------------------------------------------------------------


--------------

nslookup

--------------


apt-get install dnsutils

----

nslookup -type=ns xsrv.tk

nslookup -type=mx xsrv.tk

--------------


тест DNS записей  хоста

host -t txt mail._domainkey.xsrv.tk

==================

  команды Exim4

==================

очередь  сообщений

exiqgrep -b

или

exim -bp
exim -bpr

но  лучше 


exiqgrep -b

---
заморозить почту по адресу

exiqgrep -i -r vetroff7@ukr.net | xargs exim -Mf

---
удалить  почту  по  адресу


exiqgrep -i -r vetroff7@ukr.net | xargs exim -Mrm

---
удалений  замороженной почты

exiqgrep -zi | xargs exim -Mrm

---
Принудительная рассылка всей почты в очереди

exiqgrep -i | xargs exim -M

---
exiqgrep - Выборка из очереди

Без опций будет идентично

exim -bp

Самая главная опция это -h, которая выводит список всех опций.

-f <regexp> - регэксп совпадения с адресом отправителя
-r <regexp> - регэксп совпадения с адресом получателя
-s <regexp> - регэксп совпадения с полем размера (именно с полем размера, в том виде как оно указывается при выводе exim -bp)
регэкспы не надо заключать в //

-y <seconds> - выводит сообщения "младше" заданного количества секунд
-o <seconds> - выводит сообщения "старше" заданного количества секунд
-z - только frozen сообщения
-x - все кроме frozen
-c - Показать только количество совпадений (в зависимости от версии показывает либо просто число, либо фразу типа "15 matches out of 78 messages")
-l - Показывает полную информацию, как её выводит exim (включено по умолчанию)
-i - Показывает только IDs совпавших сообщений
-b - Показывает совпадения в "кратком" формате. Одна строка: ID, From и To
-R - Выводит сообщения в обратном порядке


-------------------------


Exim

===========================


exim -d+all

дебаг  Exim




dpkg-reconfigure exim4-config

настройки
===========================



поиск файла  по  содержимому

=======================================

find . -type f |xargs grep -l postmaster@nl.xsrv.tk

=======================================


==============================

 просмотр открытых сетевых процесов

==============================

 lsof -n|grep dbmail|grep TCP 

==============================


==============================

    удаление  ненужного

==============================

OpenVZ

apt-get remove apache2 bind9 module-init-tools quota sysklogd klogd rsync xinetd samba nscd portmap sendmail sasl2-bin wide-dhcpv6-client fetchmail udev

apt-get -y purge bind9-* xinetd samba-* nscd-* portmap sendmail-* sasl2-bin wide-dhcpv6-client* fetchmail* 

apt-get -y purge bind9-* xinetd samba-* nscd-* portmap sendmail-* sasl2-bin wide-dhcpv6-client* fetchmail* rsync* rpcbind* quota* udev*


KVM

apt-get -y remove bsd-mailx exim4 exim4-base exim4-config exim4-daemon-light nfs-common rpcbind


rm /etc/init.d/exim4
rm /etc/init.d/nfs-common
rm /etc/init.d/rpcbind


минимальная  установка  rcconf

[*] bootlogs
[*] checkroot-bootclean.sh
[*] cron
[*] motd
[*] procps
[*] rsyslog
[*] ssh
[*] sudo
[*] vnstat 



==============================


размер папки 

du -ch folder

man du руководство
----------------------------


  SSH  логирование


-----------------------------


\putty\logs\&H_&Y-&M-&D-&T.log


-----------------------------



============================

 утилита  DIG использование

===========================

http://linux.die.net/man/1/dig


dig ptr 204.203.202.201.in-addr.arpa

---------------------------



============================

  Команды  для  BIND9

============================

перечитать конфиги

rdnc reload

--

перечитать зону с мастера

rndc retransfer test.com

--

генерация ключей TSIG

dnssec-keygen -a HMAC-MD5 -b 128 -n HOST <имя ключа>

=============================


    nano

============================

выйти в  консоль

ctrl+z

вернуться обратно

fg


===============================

  архиватор  tar

===============================

Архиватор Tar
Форматы tar.gz и tar.bz2 представляют собой сжатые архивы tar с помощью gzip и bzip методов.
Примеры использования:
создание архива tar
tar cf archive.tar file.txt
создание сжатого архива tar.gz
tar czf archive.tar.gz file.txt
создание сжатого архива tar.bz2
tar cjf archive.tar.bz2 file.txt
создание архива tar с автоматическим сжатием на основании расширения (в данном случаи — .gz)
tar cfa archive.tar.gz file.txt
извлечение из архива
tar xf archive.tar
tar xzf archive.tar.gz
tar xjf archive.tar.bz2
Также можно извлекать из архива без указания типа сжатия:
tar xf archive.tar
tar xf archive.tar.gz
tar xf archive.tar.bz2
просмотр содержимого архива archive.tar.bz2
tar tf archive.tar.bz2
Подробности в man tar
Сжатые Gzip архивы имеют расширение gz, .Z, .z, .taz или .tgz и могут быть распакованы через
gunzip file_name


Используемые в команде ключи

    x - позволяет вам извлекать файлы из архива.
    v - делает вывод tar подробным. Это означает, что на экран будут выведены все найденные в архиве файлы. Если эта опция опущена, информация, выводимая в процессе обработки, будет ограничена.
    f - является обязательной опцией. Без неё tar пытается использовать магнитную ленту вместо файла архива.
    z - позволяет вам обрабатывать архив, сжатый gzip'ом (с расширением .gz). Если вы забудете указать эту опцию, tar выдаст ошибку. И наоборот, эта опция не должна использоваться для несжатых архивов. 

=================================

=============================

	замена  syslog

=============================


apt-get install -y syslog-ng && dpkg --purge rsyslog


-----------------------------


=============================

 поиск файлов  locate

=============================

apt-get install locate

updatedb

locate -b <file_base_name>
-----------------------------



=============================

      apache2 rpaf

=============================

apt-get install libhtml-parser-perl libwww-perl libcompress-zlib-perl

service apache2 restart

apt-get install apache2-prefork-dev

service apache2 restart

--

cd /usr/local/src
wget http://stderr.net/apache/rpaf/download/mod_rpaf-0.6.tar.gz
tar xzf mod_rpaf-0.6.tar.gz
cd mod_rpaf-0.6
apxs2 -i -c -n mod_rpaf-2.0.so mod_rpaf-2.0.c

--

Создаем файл rpaf-2.0.load и вписываем туда
LoadModule rpaf_module /usr/lib/apache2/modules/mod_rpaf-2.0.so
RPAFenable On
RPAFsethostname On
RPAFproxy_ips 127.0.0.0 x.x.x.x

--

Где 127.0.0.0 и x.x.x.x, это IP-адреса прокси серверов с которых приходит запрос (например nginx)
Сохраняем и закачиваем файл в раздел

/etc/apache2/mods-available/

--

Включаем модуль mod_rpaf

a2enmod rpaf-2.0

--
Перезапускаем Апач

service apache2 restart


в  /etc/apache2/apache2.conf

добавить  

RPAFproxy_ips 127.0.0.1
RPAFEnable On

service  apache2 restart

-----------------------------


========================================

 скрыть вывод информации  о  ПО
 отключение вывода системной информации

========================================

--

/etc/nginx/nginx.conf

добавить в  секцию 

http {
	server_tokens      off;
}

--

/etc/apache2/apache2.conf


добавить

ServerTokens ProductOnly
ServerSignature Off

--

/etc/php5/apache2/php.ini

expose_php = Off

===================================

 apache2 перезагрузка конфигурации

===================================

apachectl graceful

-----------------------------------




================================

 D E B I A N  &   T  E  S  T ' s

================================


==================

  Deian tests

==================

ab is a tool for benchmarking your Apache Hypertext Transfer Protocol (HTTP) server. It is designed to give you an impression of how your current Apache installation performs. This especially shows you how many requests per second your Apache installation is capable of serving.

Installing apache ab in debian

If you want to install apache ab in debian you need to install a package called "apache2-utils".

This package contains utility programs for webservers

Provides some add-on programs useful for any webserver. These include:

- ab (Apache benchmark tool)
- logresolve (Resolve IP addresses to hostname in logfiles)
- htpasswd (Manipulate basic authentication files)
- htdigest (Manipulate digest authentication files)
- dbmmanage (Manipulate basic authentication files in DBM format, using perl)
- htdbm (Manipulate basic authentication files in DBM format, using APR)
- rotatelogs (Periodically stop writing to a logfile and open a new one)
- split-logfile (Split a single log including multiple vhosts)
- checkgid (Checks whether the caller can setgid to the specified group)
- check_forensic (Extract mod_log_forensic output from apache log files)

If you want to install this run the following command

#apt-get install apache2-utils

If you want to test the apache ab command example as follows

#ab -kc 10 -t 30 http://localhost/

This will open 10 connections, using Keep-Alive on them and hammering localhost for 30 seconds through those connections. When done, you'll get some charts about test.For best results, you should run this program for another machine.

If you want to know more options and how to user apache ab check the apache ab man page click here for this man page

---------------------
 тест  вебсервера

ab -kc 100 -t 600 http://allpsd.net/
ab -kc 10 -t 300 http://xsrv.tk/


первая цифра: кол-во keep-alive подключений
вторая цифра: время тестирования

---------------------


cat /proc/cpuinfo

==================
запуск Nginx

/usr/local/sbin/nginx  


или  со  скриптом

/etc/init.d/nginx start


удаление  содержимого  каталога

rm -r /var/cache/* 



mz eth0 -c 0 -Q 50,100 -A rand -B 195.64.154.47 -t tcp "flags=syn, dp=80"

plowdown -a mail@gmail.com:pass

/etc/init.d/rtorrentInit.sh start/stop/restart

lftp -f /home/_chats/crons/ftp_backups


mz eth0 -c 0 -Q 50,100 -A rand -B 195.64.154.47 -t tcp "flags=syn, dp=80"



==================

  Deian tests

==================


cat /proc/cpuinfo

dd if=/dev/zero of=test bs=64k count=16k conv=fdatasync

==================


==================
  
      ntp

==================

apt-get install ntpdate

ntpdate <server name>


servers list: 
------------


SE
--
ntp.cyberinfo.se


-------------------


-------------------

   phpmyadmin

--------------------
Сервер использует защитную систему Suhosin

скрыть

nano /usr/share/phpmyadmin/config.inc.php

добавить строчку

$cfg['SuhosinDisableWarning'] = boolean;


-------------------


-------------------

    logrotate

-------------------

тестируем  конфигурацию

logrotate -d /etc/logrotate.d/bind9


применяем конфигурацию

logrotate -v -f /etc/logrotate.d/bind9


-------------------


=====================

  архиватор tar TAR

=====================

создать  архив папки

tar -cvf <имя_архива>.tar <имя_папки>


=====================

управление автозагрузкой

=====================

apt-get install rcconf


=====================

   NTP  server

=====================

просмотр  пиров

ntpq -c peers -n


просмотр  пула

ntpq -p


Трассировка NTP маршрута утилитой ntptrace

ntptrace

ntpdate

-q указывает не изменять время
-d отладочный режим без изменения времени 

----------------------------

Установка независимого времени для VPS

----------------------------
         для XEN
        ---------
Individual Linux VMs can be set to maintain independent times

1. From a root prompt on the VM, type the command: echo 1 > /proc/sys/xen/independent_wallclock

2. This can be persisted across reboots by changing the /etc/sysctl.conf configuration file and adding:

# Set independent wall clock time
xen.independent_wallclock=1

3. As a third alternative, the independent_wallclock=1 may also be passed as a boot parameter to the VM.



        для KMV
      -----------
dmesg | grep kvm-clock
netstat -lnp

cat /sys/devices/system/clocksource/clocksource0/available_clocksource
cat /sys/devices/system/clocksource/clocksource0/current_clocksource

kvm-clock tsc hpet acpi_pm


# рекомендации для VMWare

divider=10 clocksource=acpi_pm

------------------------------------------
 ----------------------------------------
  как переключить clocksource для KVM
 ----------------------------------------
------------------------------------------

nano /etc/default/grub

 редактировать строку

GRUB_CMDLINE_LINUX_DEFAULT="quiet"

 добавить clocksource=tsc

 должно  выглядеть  так 


--------------
 для Debian 6
--------------

GRUB_CMDLINE_LINUX_DEFAULT="quiet clocksource=tsc"

--------------
 для Debian 7
--------------

nano /etc/default/grub

GRUB_CMDLINE_LINUX_DEFAULT="quiet nohz=off highres=off clocksource=tsc"


 далее  обновим  grub.cfg, выполнив команду

update-grub

 для применения параметров требуется перезагрузка

shutdonwn -r now

reboot

 проверим,  изменился  ли  clocksource на требуемый

cat /sys/devices/system/clocksource/clocksource0/current_clocksource

 если вывод  будет  следующим

tsc

  значит  все  прошло  успешно.

 так же можно  посмотреть лог  загрузки


dmesg | grep tsc
[    0.000000] Kernel command line: BOOT_IMAGE=/vmlinuz-2.6.32-5-686 root=UUID=fb78eb09-ced8-45d7-8d3d-50143ec2c3c6 ro quiet clocksource=tsc
[    0.052028] Switching to clocksource tsc


*успешно работает на EDIS KVM

-----------------------------

       для XEN-PV

-----------------------------

nano /boot/grub/menu.lst

строка 

kernel  ---> добавить  в  конец nohz=off highres=off clocksource=tsc

=============================

 вывод  команд  на  консоль

=============================

В линуксе вот такое катит: echo «hello» > /dev/pts/1 

где  цифра  в  конце значит  номер открытого окна



=======================================

 Информация выводимая командой ntpq -p

=======================================

Символ в начале строки:

    пробел - слишком большой страт, цикл или явная ошибка
    x - фальшивый источник по алгоритму пересечения
    . - исключен из списка кандидатов из-за большого расстояния
    - - удалено из списка кандидатов алгоритмом кластеризации
    + - входит в конечный список кандидатов
    # - выбран для синхронизации, но есть 6 лучших кандидатов
    * - выбран для синхронизации
    o - выбран для синхронизации, но используется PPS

    remote - имя удаленного ntp сервера. Если использовать ключик -n, то будет показан IP
    refid - показывает откуда этот сервер берет время. Тут может быть имя (или IP) другого сервера или что то типа .GPS., .PPS. и т. п.
    st - Stratum - слой в котором работает данный сервер, число от 1 до 16 указывающее удаление от источника синхронизации (например GPS или PPS). Слой данного сервера на 1 больше слоя сервера по которому идет синхронизацию.
    t - Тип удаленного сервера (local, unicast, multicast or broadcast)
    when - сколько секунд назад был получен последний пакет от данного сервера
    poll - период опроса сервера, секунд.
    reach - восьмеричное представление массива из 8-ми бит, в котором фиксируется 8 последних попыток синхронизации. Если попытка была успешной, то устанавливается 1. Значение 377 говорит о том, что все 8 последних попыток были удачными.
    delay - вычисленная задержка ответов от сервера (RTT) в миллисекундах
    offset - разница во времени между локальным и удаленным сервером, мс. Одно из наиболее важных значений. Чем оно меньше тем точнее время.
    jitter - дисперсия отклонения удаленных часов относительно локальных, вычисленная по нескольким последним запросам, мс. Чем меньше это значение тем более точная возможно синхронизация.

    A negative offset means that the PC is faster than perfect;
    a positive offset means that the PC is lagging behind.

    значение offset

    - 'offset' негативное значение  указывает, что часы локальном сервере спешат
    + 'offset' позитивное значение  свидетельствует об отставании часов на локальном сервере

---------------------------------------

========================================

        UnixBench 5.1.3

========================================

The simplest way to generate results is with the commmand:
    ./Run

---------------------------------------
========================================
     сетевая утилита мониторинга
               nmap
========================================

nmap - scan your server for open ports
----------------------------------------

========================================

========================================

    сетевая утилита мониторинга
                lsof
========================================


---------------------------------------
========================================
  сетевая утилита мониторинга

          установка ntop

========================================
установка доступна  из  backports

nano /etc/apt/sources.list

deb http://backports.debian.org/debian-backports squeeze-backports main

или

ссылка  на  исходники

http://switch.dl.sourceforge.net/project/ntop/ntop/Stable/


установка необходимых пакетов

apt-get install subversion bison libgdbm-dev zlib1g-dev rrdtool librrd-dev libssl-dev python-dev libgeoip-dev graphviz libgraphviz-dev

установим свежую версию libpcap из исходников с  сайта http://www.tcpdump.org/


в  процессе  так  же  потребуется flex

http://flex.sourceforge.net/


далее  выполнить команду

chown -R nobody:nogroup /usr/local/var/ntop

если  будет  ошибка

ntop: error while loading shared libraries: libntopreport



cp /etc/ld.so.conf

добавить в папку  "/usr/local/lib" файл /etc/ld.so.conf затем выполнить команду

"ldconfig" чтобы перезагрузить файл



cp /etc/ld.so.conf /usr/local/lib/ld.so.conf

cd /usr/local/lib/

ldconfig

запустить ntop,  задать пароль администратора


для  Traffic  map установить  

apt-get install python-setuptools python-mako



запуск

ntop -P /etc/ntop -W4242 -d


-P читать конфиг  в  /etc/ntop

-W - работать на указанном  порте

-d  запуск  в  качестве демона


-----
если  устанавливаем  из  собраного  .deb пакета  надо доустановить:

apt-get install libgdbm-dev zlib1g-dev rrdtool librrd-dev libssl-dev python-dev libgeoip-dev graphviz libgraphviz-dev


если  будет ругаться на  отсутствующие  библиотеки - запускать ldconfig


далее  mkdir /usr/local/var/
mkdir /usr/local/var/ntop

chown -R nobody:nogroup /usr/local/var/ntop

первый  раз  запускать ntop,
не  в  качестве  демона,  чтобы  задать  пароль доступа  к  админке.

если  не  будет  спраашивать  пароль,  удалить  'ntop_pw.db'

здесь /usr/local/var/ntop

---------------------------------------

=======================================

           MySQL изменения

=======================================

'--skip-locking' is deprecated and will be removed in a future release. Please use '--skip-external-locking' instead.
--default-character-set' is deprecated and will be removed in a future release. Please use '--character-set-server' instead.

=======================================


dmesg | grep eth0


========================================

          sysctl

========================================

sysctl -a|grep ipv6 

you will get a list of all available sysctl's referring specifically to ipv6

получим  все  значения  которіе  возможно  указать  в  sysctl  для  IPv6

----------------------------------------

===========================================

  просмотр списка установленных пакетов

===========================================
http://itshaman.ru/articles/7/komandy-linux


dpkg -l |more

поиск пакетов по имени

apt-cache search имя пакета

apt-cache showpkg имя пакета

--------------------------------------------

    управление  уровнями загрузки

--------------------------------------------

apt-get install sysv-rc-conf

--------------------------------------------

=============================================


    отложеный  запуск  при  загрузке

=============================================

ntp-boot

sh -c "sleep 5 && service ntp start"


bind9-boot

sh -c "sleep 7 && service bind9 start"

nginx-boot

sh -c "sleep 9 && service nginx start"


apache2-boot

sh -c "sleep 11 && service apache2 start"

================================================

		разобраться

Using makefile-style concurrent boot in runlevel 2

================================================


       добавление удаление консолей

================================================

nano /etc/inittab

1:2345:respawn:/sbin/getty 38400 tty1

init q

------------------------------------------------

================================================

   управление  сервисами с update-rc.d

================================================
добавить сервис в загрузку

update-rc.d apache2 defaults


удалить сервис из загрузки

update-rc.d -f apache2 remove


=================================================

         tcpdump ipv6  

=================================================

tcpdump -vv ip6 -i eth0

-------------------------------------------------

===================================

        eaccelerator

===================================
eAccelerator is a free open-source PHP accelerator & optimizer.


apt-get install php5-dev
apt-get install make
phpize
./configure --enable-eaccelerator=shared
make
checkinstall


-----------------------------------

====================================

         SpamAssassin

====================================

service spamassassin stop

------------------------------------


====================================

       использование .tar

====================================


    x - позволяет вам извлекать файлы из архива.
    v - делает вывод tar подробным. Это означает, что на экран будут выведены все найденные в архиве файлы. Если эта опция опущена, информация, выводимая в процессе обработки, будет ограничена.
    f - является обязательной опцией. Без неё tar пытается использовать магнитную ленту вместо файла архива.
    z - позволяет вам обрабатывать архив, сжатый gzip'ом (с расширением .gz). Если вы забудете указать эту опцию, tar выдаст ошибку. И наоборот, эта опция не должна использоваться для несжатых архивов. 

распаковать

tar -xzvf

упаковать

tar -cvf
------------------------------------

список  файлов в архиве

tar -ztf <file.tar.gz> | less

====================================

     использование  gzip

====================================



====================================

         CSF  firewall

====================================
install libwww-perl


wget http://www.configserver.com/free/csf.tgz
tar -xzf csf.tgz
cd csf
sh install.sh


Webmin > Webmin Configuration > Webmin Modules >
  From local file > /etc/csf/csfwebmin.tgz > Install Module 


apt-get install zip unzip
apt-get install libtext-csv-perl

iptables -L -n -v

------------------------------------


=====================================

тестирование пропускной способности

            iperf

=====================================

apt-get install iperf

запуск в качестве сервера-демона
iperf -D -s

iperf -c <host> -i5 -n100m /или -t60/

====================================

       Debian  модуль
      загрузка модулей

====================================

apt-get install modconf

------------------------------------


====================================

       xterm-256 color test

====================================

:runtime syntax/colortest.vim

------------------------------------


====================================

Установка пакетов из тестового репозитория в Debian

====================================

apt-get -t testing install <packagenamehere>

------------------------------------


====================================

          плагины  MySQL

====================================

SHOW PLUGINS\G

------------------------------------


saslauthd


apt-get purge  	sasl2-bin wide-dhcpv6-client xinetd  fetchmail 


=====================================


#!/bin/sh
while [ 1 ]; do
  curl http://iwipo.com/
  sleep 10
done


---------------------------------------

список установленных пакетов

---------------------------------------

dpkg -l |less 

apt-get purge isc-dhcp-client

---------------------------------------

#!/bin/sh
while [ 1 ]; do
  curl --insecure --max-time 1 $1 > /dev/null
  sleep 0.1
done


=====================================

             3proxy

=====================================





-------------------------------------

=====================================



=======================================

  добавление  скрипта  в  автозагрузку

=======================================

update-rc.d 3proxy defaults

Удаление скрипта из автозагрузки

update-rc.d -f имя remove


========================================

    Установка nginx из исходников

          nginx  исходники   

========================================

http://habrahabr.ru/post/67557/

http://rtzra.ru/wiki/software/nginx/installation

http://www.linuxspace.org/archives/1439
----------------------------------------
установить библиотеки

apt-get -y install geoip-database libgeoip1

apt-get -y install libpcre3 libpcre3-dev libpcrecpp0 libssl-dev zlib1g-dev


!!!

wget http://security.debian.org/debian-security/pool/updates/main/libx/libxslt/libxslt1.1_1.1.26-6+squeeze2_i386.deb
dpkg -i libxslt1.1_1.1.26-6+squeeze2_i386.deb




---------
apt-get -y install libxslt1-dev libgd2-xpm-dev

./configure --help


--conf-path=/etc/nginx/nginx.conf
--http-log-path=/var/log/nginx/access.log
--error-log-path=/var/log/nginx/error.log
--lock-path=/var/lock/nginx.lock
--pid-path=/var/run/nginx.pid
--with-debug
--with-http_addition_module
--with-http_dav_module
--with-http_geoip_module
--with-http_gzip_static_module
--with-http_image_filter_module
--with-http_realip_module
--with-http_stub_status_module
--with-http_ssl_module
--with-http_sub_module
--with-http_xslt_module
--with-http_flv_module
--with-ipv6
--with-mail
--with-mail_ssl_module
--with-sha1=/usr/include/openssl
--with-md5=/usr/include/openssl
--user=www-data
--group=www-data



./configure --conf-path=/etc/nginx/nginx.conf --http-log-path=/var/log/nginx/access.log --error-log-path=/var/log/nginx/error.log --lock-path=/var/lock/nginx.lock --pid-path=/var/run/nginx.pid --with-debug --with-http_addition_module --with-http_dav_module --with-http_geoip_module --with-http_gzip_static_module --with-http_image_filter_module --with-http_realip_module --with-http_stub_status_module --with-http_ssl_module --with-http_sub_module --with-http_xslt_module --with-http_flv_module --with-ipv6 --with-mail --with-mail_ssl_module --with-sha1=/usr/include/openssl --with-md5=/usr/include/openssl --user=www-data --group=www-data

----


посмотреть версию
nginx -V


----

mkdir /etc/nginx
mkdir /etc/nginx/sites-available
mkdir /etc/nginx/sites-enabled
mkdir /var/log/nginx

mkdir /var/lib/nginx/

----

ln -s /usr/local/nginx/sbin/nginx /usr/local/bin/ /не обязательно/

----

cp /etc/nginx/nginx.conf.default /etc/nginx/nginx.conf
cp /etc/nginx/mime.types.default /etc/nginx/mime.types
cp /etc/nginx/fastcgi_params.default /etc/nginx/fastcgi_params


----

cd /etc/init.d/
wget http://nl.xsrv.tk/files/cnf/nginx/init.d/nginx
chmod 755 /etc/init.d/nginx
update-rc.d nginx defaults




---------------

  зависимости 

---------------

при компиляции


apt-get -y install geoip-database libgeoip1 libxslt1-dev libgd2-xpm-dev

----

после установки пакета


apt-get -y install libxslt1.1  libgd2-xpm geoip-database

===============================

             boinc

================================

apt=get install boinc-client

boinc --daemon

boinc -help


# только  отсюда работают команды

cd /var/lib/boinc-client/


boinccmd


-show_projects

-reset_project URL


boinccmd  --project_attach  http://www.worldcommunitygrid.org  840ba82d2f245c20073522cec001d679


добавить проект

--project_attach URL auth<Account Key from project My Profile >

управлять проектами
--project URL {reset | detach | update | suspend | resume | nomorework | allowmorework} 

reset - «Перезапустить проект»
detach - «Удалить проект»
update - «Обновить» информацию с сервера проекта
suspend - «Приостановить» обработку проекта
resume - «Запустить» обработку проекта
nomorework - «Не запрашивать задания»
allowmorework - «Получать новые задания»

boinccmd --project  http://www.worldcommunitygrid.org update




boinc --daemon

для запуска

Выделено ресурсов
Определяет пропорции ресурсов вашего компьютера, выделенных этому проекту.
Пример: если Вы участвуете в двух проектах BOINC с долями ресурсов 100 и 200,
первый получит 1/3 ваших ресурсов, а второй получит 2/3.

100 - 1/4 = 4 CPU
300 - 3/4 = 12 CPU

всего ресурсов 400

------------------

100% ресурсов
5 проектов

1000

--------------------------------------------------
|       project         |  weight  |   %   | cpu
--------------------------------------------------
| World Community Grid 	|   375    |  37.5 |  8
| MilkyWay@home		|   250    |  25   |  4
| LHC@home		|   125    |  12.5 |  1
| Einstein@Home		|   125    |  12.5 |  2
| SETI@home		|   125    |  12.5 |  1
--------------------------------------------------

16 CPU всего

1 - 6.25%	625
2 - 12.5%	1250
3 - 18.75%	1875
4 - 25%		2500
5 - 31.25%	3125
6 - 37.5%	3750
7 - 43.75	4375
8 - 50%		5000
9 - 56.25%	5625
10 - 62.5%	6250
11 - 68.75%	6875
12 - 75%	7500
13 - 81.25%	8125
14 - 87.5%	8750
15 - 93.75%	9375
16 - 100%	10000


16=6+4+2+2+2


-------------

16=8+4+1+2+1	5000 + 2500 + 625 + 1250 + 625

--------------------------------------------------
|       project         |  weight  |   %   | cpu
--------------------------------------------------
| World Community Grid 	|   5000   |  50   |  8
| MilkyWay@home		|   2500   |  25   |  4
| LHC@home		|   625    |  6.25 |  1
| Einstein@Home		|   1250   |  12.5 |  2
| SETI@home		|   625    |  6.25 |  1
--------------------------------------------------


----

информация о проэктах

boinccmd --get_project_status
boinccmd --get_state

----

обновление


cd /var/lib/boinc-client/


# World Community Grid

boinccmd --project  http://www.worldcommunitygrid.org/ update


# MilkyWay@home

boinccmd --project http://milkyway.cs.rpi.edu/milkyway/ update


# LHC@home

boinccmd --project http://lhcathomeclassic.cern.ch/sixtrack/ update


# Einstein@Home

boinccmd --project  http://einstein.phys.uwm.edu/ update



# SETI@home

boinccmd --project http://setiathome.berkeley.edu/ update
 



=================================

           nxserver

        64.207.180.164
=================================

Change your working directory to the location where you saved the package and install it by running from a console:

dpkg -i nxclient_3.5.0-7_amd64.deb
dpkg -i nxnode_3.5.0-9_amd64.deb
dpkg -i nxserver_3.5.0-11_amd64.deb


The NX service can be controlled by the command


/usr/NX/bin/nxserver --status|--start|--stop|--restart.

Additional commands are available to configure the server

Try /usr/NX/bin/nxserver --help for more information.

Please, don't forget to download and read the NX Server Administrator's Guide available here. 

http://www.nomachine.com/documentation/admin-guide.php



добавление пользователя NXserver

cd /usr/NX/bin

nxserver --useradd vis --passwd 456/*-

предварительно надо добавить пользователя в систему

adduser vis



проверка пользователя 

/usr/NX/bin/nxserver --usercheck vis


добавить в /etc/ssh/sshd_config


AllowAgentForwarding yes
AllowTcpForwarding yes
X11Forwarding yes
X11UseLocalhost yes
PermitTunnel yes


vis;vis456

про  путаницу с ключами
-----------------------------------



-------------------------------------
показать размер файла

ls -l /etc/hosts

--------------------------------------

===================

     vnstat

===================
создать базу

vnstat -u -i eth0 

--------------------


====================

   выключение

====================

poweroff
halt
shutdown -h now

для перезагрузки системы используйте команду reboot.



=====================

      xfce4

=====================


apt-get -y install xorg tint2 gksu gdebi terminator file-roller lha lzop rzip unalz zoo xz-utils p7zip-full alsa-base vlc audacity lame gimp ttf-freefont ttf-mscorefonts-installer gcolor2 agave gedit gedit-plugins evince gcalctool iceweasel gftp xchat transmission-gtk wicd cups cups-pdf system-config-printer hpijs hplip dmz-cursor-theme gtk2-engines-murrine tango-icon-theme gnome-colors bash-completion screen cowsay figlet scrot whois rpl conky-all zenity gparted xfsprogs reiserfsprogs reiser4progs jfsutils synaptic ttf-bitstream-vera ttf-dejavu ntfs-3g pcmciautils parcellite fontconfig-config libcairo2 firmware-linux firmware-iwlwifi


apt-get -y install xfce4 xfdesktop4 xfce4-power-manager xfce4-screenshooter xfce4-notifyd thunar thunar-archive-plugin thunar-media-tags-plugin thunar-thumbnailers gvfs-backends gvfs-bin gvfs-fuse xfce4-mixer xfburn xfce4-xkb-plugin


# apt-get -y install libreoffice libreoffice-gtk # Office install


apt-get -y install gdm


http://unix4me.ru/archives/1048
---------------------------------

Debian: Ставим Xfce 4.8 на squeeze 

---------------------


==========================

  arno-iptables-firewall

=========================


для поддержки IPv6


apt-get -y -t testing install  arno-iptables-firewall


-----------------


=========================

Install Dropbox client version 


for Linux Debian wheezy


=========================


=========================


    pppoeconf


pon dsl-provider


---------------------------




============================

  OpenVZ  DNS resolvers 

============================

crontab -e

@reboot rm /etc/resolv.conf
@reboot cp /var/www/files/cnf/resolv/resolv.conf /etc/resolv.conf


----------------------------


============================

 OpenVZ  удаляем ненужное

============================

apt-get -y purge fetchmail  wide-dhcpv6-client klogd portmap sasl2-bin sysklogd xinetd apache2-* samba && apt-get install apache2-utils && apt-get -y autoremove




===============================

  SSH  RSA-key аунтетификация

===============================

mkdir ~/.ssh
nano ~/.ssh/authorized_keys

chmod 600 ~/.ssh
chmod 400 ~/.ssh/authorized_keys

nano /etc/ssh/sshd_config

раскоментировать  строки:

AuthorizedKeysFile	%h/.ssh/authorized_keys
PasswordAuthentication	no

----------------------------


===============

  HDPARM

===============


apt-get -y install hdparm

hdparm -t /dev/xvda1



----------------

======================

  ДАТЧИКИ  Консоль


========================


На форуме уже где то было.

Необходимо изменить строку в  /etc/default/grub

GRUB_CMDLINE_LINUX="acpi_enforce_resources=lax"

затем  sudo update-grub2


update-grub

 для применения параметров требуется перезагрузка

shutdown -r now


  значит  все  прошло  успешно.

 так же можно  посмотреть лог  загрузки


dmes



g | grep lax


104DOMSPECIAL


vetroff.net
vtrf.net


---------------------


======================


  crontab

======================


crontab -e


-----------------------


=======================

       MariaDB

=======================


Замена MySQL на MariaDB в Debian

Импортируем GPG ключ репозитория:

apt-key adv --recv-keys --keyserver keyserver.ubuntu.com 1BB943DB

Открываем файл:

nano /etc/apt/sources.list

Добавляем новые источники приложений:

deb http://mirror2.hs-esslingen.de/mariadb/repo/5.5/debian squeeze main
deb-src http://mirror2.hs-esslingen.de/mariadb/repo/5.5/debian squeeze main


---

Кстати можно сгенерировать их здесь: http://downloads.askmonty.org/mariadb/repositories/

---

Обновляем список приложений:

apt-get update

Устанавливаем MariaDB:

apt-get -y install mariadb-server-5.5

Проверяем:

mysql -V


-----------------------


========================

dpkg не настраивает пакеты

========================

Ошибка при обновлении или установке чего либо, cupsys Sub-process /usr/bin/dpkg

http://forum.ubuntu.ru/index.php?topic=46208.0




Например, если это
Цитата: Spot от 19 Октябрь 2009, 20:51:18

    Код: [Выделить]


    dpkg: не удалось обработать параметр vmware-server (--remove):
     подпроцесс post-removal script возвратил код ошибки 2
    При обработке следующих пакетов произошли ошибки:
     vmware-server
    E: Sub-process /usr/bin/dpkg returned an error code (1)

то нам достаточно сделать следующее:
Код: [Выделить]

cd /var/lib/dpkg/info
rm vmware-server.*
apt-get -f install

В результате удаляются пре- и постинсталяционные скрипты, мд5-сумма пакета и файллист.
В /var/cache/apt/archives у меня ничего не было. Но на всякий случай, можете залезть туда и тоже там почистить всё что относится к зависшему пакету. 
=========================


---------------------------
          
        РЕШЕНИЕ


dpkg

---------------------------


удаляем файлы  "плохого"  пакета

rm -rf /var/cache/debconf/*

dpkg-reconfigure debconf

apt-get update && apt-get upgrade


http://forum.ubuntu.ru/index.php?topic=46208.15

  ставится  пакет


cd /var/lib/dpkg/info
rm vsftpd.*
apt-get -f install


-------------------------------------------------



==============================

           pdnsd

==============================

очистка кэша


одиночная запись:

pdnsd-ctl record example.com delete


или сразу все:

sudo pdnsd-ctl empty-cache


-------------------------------


===============================


 Как восстановить информацию
о установленных в системе пакетах?

================================

aptitude search ~i -F %p --disable-columns | while read pk---------------------



================================


       debian squeeze xfce


================================


apt-get install xorg tint2 gksu gdebi terminator file-roller lha lzop rzip unalz zoo xz-utils p7zip-full alsa-base vlc audacity libdvdcss2 lame gimp ttf-freefont ttf-mscorefonts-installer gcolor2 agave gedit gedit-plugins evince gcalctool iceweasel gftp xchat transmission-gtk wicd cups cups-pdf system-config-printer hpijs hplip dmz-cursor-theme gtk2-engines-murrine tango-icon-theme gnome-colors bash-completion screen cowsay figlet scrot whois rpl conky-all zenity gparted xfsprogs reiserfsprogs reiser4progs jfsutils synaptic ttf-bitstream-vera ttf-dejavu ntfs-3g pcmciautils parcellite fontconfig-config libcairo2 firmware-linux firmware-iwlwifi

далее ставим xfce

apt-get install xfce4 xfdesktop4 xfce4-power-manager xfce4-screenshooter xfce4-notifyd thunar thunar-archive-plugin thunar-media-tags-plugin thunar-thumbnailers gvfs-backends gvfs-bin gvfs-fuse xfce4-mixer xfburn xfce4-xkb-plugin


при необходимости  libreoffice из testing ветки

apt-get install libreoffice libreoffice-gtk

Ну и gdm

apt-get install gdm


--------------------------------


================================

   зеркала  репозитории

================================


http://unix4me.ru/archives/991
http://unix4me.ru/archives/1048


apt-get -t testing install <имя пакета>


--------------------------------


===============================

   arno-iptables-firewall

===============================

старт/стоп 

service arno-iptables-firewall start
service arno-iptables-firewall stop

поддержка IPv6

locate ip6tables

--------------------------------


================================

          rtorrent

================================
http://code.google.com/p/rutorrent/wiki/Plugins?wl=ru


cd /var/www/rutorrent/plugins/
svn checkout http://rutorrent.googlecode.com/svn/trunk/plugins/<plugin name>
chown -R www-data:www-data /var/www/rutorrent/plugins/

================================

================================

           php5

================================

apt-get install libapache2-mod-php5 php-auth php-auth-sasl php-mail-mime php-mail-mimedecode php-mdb2 php-mdb2-driver-mysql php-net-smtp php-net-socket php-pear php5 php5-cli php5-common php5-curl php5-dev php5-gd  php5-imagick php5-imap php5-intl php5-mcrypt php5-memcache php5-ming php5-mysql php5-pspell php5-recode php5-snmp php5-sqlite php5-suhosin php5-tidy php5-xmlrpc php5-xsl phpmyadmin


E: Не удалось найти пакет php-auth-sasl
E: Не удалось найти пакет php-mail-mime
E: Не удалось найти пакет php-mail-mimedecode
E: Не удалось найти пакет php-mdb2
E: Не удалось найти пакет php-mdb2-driver-mysql
E: Не удалось найти пакет php-net-smtp
E: Не удалось найти пакет php-net-socket
E: Не удалось найти пакет php5-ming
E: Не удалось найти пакет phpmyadmin

apt-get install libapache2-mod-php5  php-pear php5 php5-cli php5-common php5-curl php5-dev php5-gd  php5-imagick php5-imap php5-intl php5-mcrypt php5-memcache  php5-mysql php5-pspell php5-recode php5-snmp php5-sqlite php5-suhosin php5-tidy php5-xmlrpc php5-xsl

--------------------------------


================================

 Сервер использует защитную систему Suhosin.

================================

В файл phpMyAdmin-а config.inc.php надо добавить следующую строку:

$cfg['SuhosinDisableWarning'] = boolean;

--------------------------------


================================

          eAccelerator

================================

aptitude install php5-dev
aptitude install make

cd eaccelerator-0.9.5.3
phpize
./configure --enable-eaccelerator=shared
make
checkinstall



=================================

       iftop  исходники

---------------------------------
ошибка

checking where to find pcap.h... no idea
configure: error: can't find pcap.h
  You're not going to get very far without libpcap.


apt-get install libpcap0.8-dev



ln -s /usr/local/sbin/iftop /usr/sbin/iftop


---
ошибка 2

checking for a curses library containing mvchgat... none found
configure: error: Curses! Foiled again!
  (Can't find a curses library supporting mvchgat.)
  Consider installing ncurses.


apt-get install libncurses5-dev

===============================

       размер  папки

===============================

du -ch <folder_name>


================================

           lsof

================================

lsof -i :port


--------------------------------


================================

         locate

================================

updatedb


--------------------------------


===============================

        mc    команды

===============================
копировать  текущий путь в командную строку

Ctrl+x+p   



===============================

         minstall

-------------------------------


cd ~; rm -rf minstall; mkdir minstall; cd minstall; wget --no-check-certificate -O minstall.tar.gz http://www.github.com/downloads/KnightSwarm/Minstall/Latest.tar.gz; tar zxvf minstall.tar.gz; rm minstall.tar.gz

bash minstall.sh clean-packages
bash minstall.sh install-ssh

------------
  Install
------------
bash minstall.sh install-extra-repositories
bash minstall.sh clean-packages
bash minstall.sh install-ssh
bash minstall.sh install-extra-packages
------------
 Configure
------------
bash minstall.sh configure-general
bash minstall.sh configure-ssh
bash minstall.sh configure-upgrade
bash minstall.sh configure-user
------------
    HTTP
------------
bash minstall.sh http-install-exim
bash minstall.sh http-install-mysql
bash minstall.sh http-install-nginx
bash minstall.sh http-install-php
bash minstall.sh http-install-php-extra
bash minstall.sh http-configure-mysql
bash minstall.sh http-configure-nginx
------------
   Manage
------------
bash minstall.sh manage-add-user
bash minstall.sh manage-add-host
bash minstall.sh manage-manage-user
bash minstall.sh manage-manage-host
bash minstall.sh manage-remove-host



CREATE DATABASE drivers;
GRANT SELECT, INSERT, UPDATE, DELETE, CREATE, DROP ON drivers.* TO 'root'@'localhost' IDENTIFIED BY '789/*-';
FLUSH PRIVILEGES;

-------------------------------
         Debian 6
-------------------------------

# before

root@us1:~# df -h
Filesystem            Size  Used Avail Use% Mounted on
/dev/simfs            2.0G  489M  1.6G  24% /
tmpfs                  16M     0   16M   0% /lib/init/rw
tmpfs                  16M     0   16M   0% /dev/shm

-------------------------------

# after

root@us1:~/minstall# df -h
Filesystem            Size  Used Avail Use% Mounted on
/dev/simfs            2.0G  190M  1.9G  10% /
tmpfs                  16M     0   16M   0% /lib/init/rw
tmpfs                  16M     0   16M   0% /dev/shm

-------------------------------

# after ssh

root@us1:~/minstall# df -h
Filesystem            Size  Used Avail Use% Mounted on
/dev/simfs            2.0G  213M  1.8G  11% /
tmpfs                  16M     0   16M   0% /lib/init/rw
tmpfs                  16M     0   16M   0% /dev/shm

-------------------------------

# after mc

root@us1:~# df -h
Filesystem            Size  Used Avail Use% Mounted on
/dev/simfs            2.0G  279M  1.8G  14% /
tmpfs                  16M     0   16M   0% /lib/init/rw
tmpfs                  16M     0   16M   0% /dev/shm

-------------------------------

# after locales & locales-all

root@us1:~# df -h
Filesystem            Size  Used Avail Use% Mounted on
/dev/simfs            2.0G  403M  1.7G  20% /
tmpfs                  16M     0   16M   0% /lib/init/rw
tmpfs                  16M     0   16M   0% /dev/shm

-------------------------------

# after upgrade to Debian 7 /apt-get upgrade/

root@us1:~# df -h
Файловая система      Разм  Исп  Дост  Исп% смонтирована на
/dev/simfs            2,0G  589M  1,5G  29% /
tmpfs                  16M     0   16M   0% /lib/init/rw
tmpfs                  16M     0   16M   0% /dev/shm

-------------------------------

# after upgrade to Debian 7 /apt-get dist-upgrade/

root@us1:~# df -h
Файловая система Размер Использовано  Дост Использовано% Cмонтировано в
/dev/simfs         2,0G         560M  1,5G           28% /
tmpfs               16M            0   16M            0% /lib/init/rw
tmpfs               16M         4,0K   16M            1% /dev/shm
/dev/simfs         2,0G         560M  1,5G           28% /run
/dev/simfs         2,0G         560M  1,5G           28% /run/lock
tmpfs               16M         4,0K   16M            1% /run/shm



================================

      размер  каталогов

================================

apt-get  install ncdu

--------------------------------


================================

установка нужных версий  пакетов

================================

aptitude install libc6=2.11.3-2 libc-bin=2.11.3-2 locales=нужная версия glibc=нужная версия...

--------------------------------



================================


  версия  Debian

================================

cat /etc/issue

cat /etc/debian_version

lsb_release -a

---------------------------------



================================

  KVM Network Optimization

================================

If your network connection is limited to 100Mbps, your Network Card configuration
in SolusVM is probably set to Realtek 8139. Please use the Intel PRO/1000 or 
Virtio network card setting to be able to use all of your 1Gbps connection.

Additionally please append the following lines to the /etc/sysctl.conf file:

    net.core.rmem_max=16777216
    net.core.wmem_max=16777216
    net.ipv4.tcp_rmem=4096 87380 16777216
    net.ipv4.tcp_wmem=4096 65536 16777216

After saving the file, type sysctl -p for the changes to take effect.

---------------------------------


=================================

           iptables

=================================

iptables -A INPUT -d 198.50.245.105 -j DROP

iptables -n -L -v

iptables -n -L -v --line-numbers

http://vasilisc.com/21-examples-iptables


198.27.105.227


iptables -A INPUT -i eth0 -p UDP --destination-port 67:68 --source-port 67:68 -j DROP


iptables -D INPUT 1


заблокировать входящие ICMP запросы

iptables -A INPUT -p icmp --icmp-type echo-request -j DROP

или

iptables -A INPUT -p icmp --icmp-type 8 -j DROP

------

Enable or allow ICMP ping incoming client request

Rule to enable ICMP ping incoming client request ( assuming that default iptables policy is to drop all INPUT and OUTPUT packets)

SERVER_IP="202.54.10.20"
iptables -A INPUT -p icmp --icmp-type 8 -s 0/0 -d $SERVER_IP -m state --state NEW,ESTABLISHED,RELATED -j ACCEPT
iptables -A OUTPUT -p icmp --icmp-type 0 -s $SERVER_IP -d 0/0 -m state --state ESTABLISHED,RELATED -j ACCEPT

-------

Allow or enable outgoing ping request

To enable ICMP ping outgoing request use following iptables rule:

SERVER_IP="202.54.10.20"
iptables -A OUTPUT -p icmp --icmp-type 8 -s $SERVER_IP -d 0/0 -m state --state NEW,ESTABLISHED,RELATED -j ACCEPT
iptables -A INPUT -p icmp --icmp-type 0 -s 0/0 -d $SERVER_IP -m state --state ESTABLISHED,RELATED -j ACCEPT

===================================

             GRUB       

===================================

/dev/disk/by-uuid/b5bad93e-0ee3-4da5-a700-8877dea6499e

nano /etc/default/grub


#GRUB_DISABLE_LINUX_UUID=true

раскоментировать

update-grub
-----------------------------------


===================================

список файлов пакета  отсутствует

===================================

http://serverfault.com/questions/430682/dpkg-warning-files-list-file-for-package-x-missing

cd /var/cache/apt/archives/


dpkg-deb -c /var/cache/apt/archives/libc6_2.13-38_i386.deb | awk {'print $6'} | cut -f2- -d. | sed 's|^/$|/.|' | sed 's|/$||' > /var/lib/dpkg/info/libc6:i386.list
dpkg-deb -c /var/cache/apt/archives/libselinux1_2.1.9-5_i386.deb | awk {'print $6'} | cut -f2- -d. | sed 's|^/$|/.|' | sed 's|/$||' > /var/lib/dpkg/info/libselinux1:i386.list
dpkg-deb -c /var/cache/apt/archives/gcc-4.7-base_4.7.2-5_i386.deb | awk {'print $6'} | cut -f2- -d. | sed 's|^/$|/.|' | sed 's|/$||' > /var/lib/dpkg/info/gcc-4.7-base:i386.list
dpkg-deb -c /var/cache/apt/archives/libbz2-1.0_1.0.6-4_i386.deb | awk {'print $6'} | cut -f2- -d. | sed 's|^/$|/.|' | sed 's|/$||' > /var/lib/dpkg/info/libbz2-1.0:i386.list
dpkg-deb -c /var/cache/apt/archives/libdb5.1_5.1.29-5_i386.deb | awk {'print $6'} | cut -f2- -d. | sed 's|^/$|/.|' | sed 's|/$||' > /var/lib/dpkg/info/libdb5.1:i386.list
dpkg-deb -c /var/cache/apt/archives/liblzma5_5.1.1alpha+20120614-2_i386.deb | awk {'print $6'} | cut -f2- -d. | sed 's|^/$|/.|' | sed 's|/$||' > /var/lib/dpkg/info/liblzma5:i386.list
dpkg-deb -c /var/cache/apt/archives/libgcc1_4.7.2-5_i386.deb | awk {'print $6'} | cut -f2- -d. | sed 's|^/$|/.|' | sed 's|/$||' > /var/lib/dpkg/info/libgcc1:i386.list
dpkg-deb -c /var/cache/apt/archives/libsemanage1_2.1.6-6_i386.deb | awk {'print $6'} | cut -f2- -d. | sed 's|^/$|/.|' | sed 's|/$||' > /var/lib/dpkg/info/libsemanage1:i386.list
dpkg-deb -c /var/cache/apt/archives/libpam-modules_1.1.3-7.1_i386.deb | awk {'print $6'} | cut -f2- -d. | sed 's|^/$|/.|' | sed 's|/$||' > /var/lib/dpkg/info/libpam-modules:i386.list
dpkg-deb -c /var/cache/apt/archives/libsepol1_2.1.4-3_i386.deb | awk {'print $6'} | cut -f2- -d. | sed 's|^/$|/.|' | sed 's|/$||' > /var/lib/dpkg/info/libsepol1:i386.list
dpkg-deb -c /var/cache/apt/archives/libpam0g_1.1.3-7.1_i386.deb | awk {'print $6'} | cut -f2- -d. | sed 's|^/$|/.|' | sed 's|/$||' > /var/lib/dpkg/info/libpam0g:i386.list
dpkg-deb -c /var/cache/apt/archives/libustr-1.0-1_1.0.4-3_i386.deb | awk {'print $6'} | cut -f2- -d. | sed 's|^/$|/.|' | sed 's|/$||' > /var/lib/dpkg/info/libustr-1.0-1:i386.list
dpkg-deb -c /var/cache/apt/archives/libavahi-common-data_0.6.31-2_i386.deb | awk {'print $6'} | cut -f2- -d. | sed 's|^/$|/.|' | sed 's|/$||' > /var/lib/dpkg/info/libavahi-common-data:i386.list
dpkg-deb -c /var/cache/apt/archives/libtinfo5_5.9-10_i386.deb | awk {'print $6'} | cut -f2- -d. | sed 's|^/$|/.|' | sed 's|/$||' > /var/lib/dpkg/info/libtinfo5:i386.list
dpkg-deb -c /var/cache/apt/archives/libblkid1_2.20.1-5.3_i386.deb | awk {'print $6'} | cut -f2- -d. | sed 's|^/$|/.|' | sed 's|/$||' > /var/lib/dpkg/info/libblkid1:i386.list
dpkg-deb -c /var/cache/apt/archives/libslang2_2.2.4-15_i386.deb | awk {'print $6'} | cut -f2- -d. | sed 's|^/$|/.|' | sed 's|/$||' > /var/lib/dpkg/info/libslang2:i386.list
dpkg-deb -c /var/cache/apt/archives/libuuid1_2.20.1-5.3_i386.deb | awk {'print $6'} | cut -f2- -d. | sed 's|^/$|/.|' | sed 's|/$||' > /var/lib/dpkg/info/libuuid1:i386.list


wget http://ftp.us.debian.org/debian/pool/main/e/eglibc/libc6_2.13-38_i386.deb
wget http://ftp.us.debian.org/debian/pool/main/libs/libselinux/libselinux1_2.1.9-5_i386.deb
wget http://ftp.us.debian.org/debian/pool/main/g/gcc-4.7/gcc-4.7_4.7.2-5_i386.deb
wget http://ftp.us.debian.org/debian/pool/main/b/bzip2/libbz2-1.0_1.0.6-4_i386.deb
wget http://ftp.us.debian.org/debian/pool/main/d/db/libdb5.1_5.1.29-5_i386.deb
wget http://ftp.us.debian.org/debian/pool/main/x/xz-utils/liblzma5_5.1.1alpha+20120614-2_i386.deb
wget http://ftp.us.debian.org/debian/pool/main/g/gcc-4.7/libgcc1_4.7.2-5_i386.deb
wget http://ftp.us.debian.org/debian/pool/main/libs/libsemanage/libsemanage1_2.1.6-6_i386.deb
wget http://ftp.us.debian.org/debian/pool/main/p/pam/libpam-modules_1.1.3-7.1_i386.deb
wget http://ftp.us.debian.org/debian/pool/main/libs/libsepol/libsepol1_2.1.4-3_i386.deb
wget http://ftp.us.debian.org/debian/pool/main/p/pam/libpam0g_1.1.3-7.1_i386.deb
wget http://ftp.us.debian.org/debian/pool/main/u/ustr/libustr-1.0-1_1.0.4-3_i386.deb
wget http://ftp.us.debian.org/debian/pool/main/a/avahi/libavahi-common-data_0.6.31-2_i386.deb
wget http://ftp.us.debian.org/debian/pool/main/n/ncurses/libtinfo5_5.9-10_i386.deb
wget http://ftp.us.debian.org/debian/pool/main/u/util-linux/libblkid1_2.20.1-5.3_i386.deb
wget http://ftp.us.debian.org/debian/pool/main/s/slang2/libslang2_2.2.4-15_i386.deb
wget http://ftp.us.debian.org/debian/pool/main/u/util-linux/libuuid1_2.20.1-5.3_i386.deb


-----------------------------------


===================================

 ошибка locales  на 32Mb Debian

===================================

apt-get install locales locales-all

-----------------------------------


===================================

              TOR

===================================

tor --hash-password <password>

deb http://deb.torproject.org/torproject.org wheezy  main
deb http://deb.torproject.org/torproject.org experimental-wheezy main

gpg --keyserver keys.gnupg.net --recv 886DDD89
gpg --export A3C4F0F979CAA22CDBA8F512EE8CBC9E886DDD89 | sudo apt-key add -

apt-get update
apt-get install tor tor-geoipdb


-----------------------------------


====================================

            mpstat

====================================


mpstat -P ALL 1 100



====================================

        Load  average

====================================

http://www.webhostingtalk.com/showpost.php?p=8345459&postcount=20

------------------------------------


====================================

            minstall

====================================

wget -O /opt/minstall.tar.gz --no-check-certificate http://www.github.com/KnightSwarm/Minstall/archive/master.tar.gz; mkdir /opt/minstall/; tar -C /opt/minstall -f /opt/minstall.tar.gz --strip-components 1 -v -x -z; ln -s /opt/minstall/libraries/default/launcher.sh /usr/local/bin/minstall

удаление скрипта

rm -rf /opt/minstall /opt/minstall.tar.gz /usr/local/bin/minstall

cd /opt/minstall

команды

https://github.com/KnightSwarm/Minstall#sample-commands

--------------------------------------

https://github.com/Xeoncross/lowendscript

wget --no-check-certificate https://raw.github.com/Xeoncross/lowendscript/master/setup-debian.sh


https://github.com/Mins/TuxLite
------------------------------------


======================================

             gcitul

======================================

gcutil --service_version="v1beta16" --project="glass-stratum-777" ssh --zone="europe-west1-a" --ssh_user="vis"  --s

--------------------------------------



======================================

           PPTP script     

======================================

wget https://raw.github.com/cwaffles/ezpptp/master/ezpptp.sh
chmod +x ezpptp.sh && ./ezpptp.sh

OpenVZ

wget http://nl.xsrv.tk/files/scr/pptp_openvz.sh
chmod +x pptp_openvz.sh && ./pptp_openvz.sh

KVM

wget http://nl.xsrv.tk/files/scr/pptp_kvm.sh
chmod +x pptp_kvm.sh && ./pptp_kvm.sh

service pptpd start
--------------------------------------


===========================================

Could not load host key: /etc/ssh/ssh_host_ecdsa_key

===========================================

ssh-keygen -t ecdsa -f /etc/ssh/ssh_host_ecdsa_key -N '' 

-------------------------------------------


=======================================

              dig

=======================================
запрос  определенного DNS о записи

dig @8.8.8.8 xsrv.tk A


---------------------------------------


=======================================

      apache2 mod_expires

=======================================

a2enmod headers
a2enmod expires

---------------------------------------

=======================================

           vsftpd  500 OOPS

=======================================
1.
echo "deb http://ftp.cyconet.org/debian wheezy-updates main non-free contrib" >> /etc/apt/sources.list.d/wheezy-updates.cyconet.list;

apt-get update
apt-get install -t wheezy-updates debian-cyconet-archive-keyring vsftpd

2.
http://ftp.us.debian.org/debian/pool/main/v/vsftpd/vsftpd_3.0.2-3_i386.deb
http://ftp.us.debian.org/debian/pool/main/v/vsftpd/vsftpd_3.0.2-3_amd64.deb

dpkg -i vsftpd_3.0.2-3_i386.deb
dpkg -i vsftpd_3.0.2-3_amd64.deb

echo "allow_writeable_chroot=YES" >> /etc/vsftpd.conf
echo "seccomp_sandbox=NO" >> /etc/vsftpd.conf
service vsftpd reload

---------------------------------------

=======================================

        очистка  файла

=======================================

echo "" > file.txt

---------------------------------------


apt-get remove mysql-client-5.5 mysql-server-5.5  mysql-server-core-5.5 mysql-server  mysql-common mysql-client libmysqlclient18




--------------------------------------
apt-get install apache2 apache2-doc apache2-mpm-prefork apache2-utils libexpat1 ssl-cert libapache2-mod-php5 libapache2-mod-ruby php5 php5-common php5-curl php5-dev php5-gd php5-idn php-pear php5-imagick php5-imap php5-mcrypt php5-memcache php5-mhash php5-ming php5-mysql php5-pspell php5-recode php5-snmp php5-sqlite php5-tidy php5-xmlrpc php5-xsl phpmyadmin



=======================================

       заблокировать  IP

=======================================

iptables -A INPUT -s 95.240.157.13 -j REJECT


iptables-save > /etc/iptables/rules.v4
ip6tables-save > /etc/iptables/rules.v6

http://www.microhowto.info/howto/make_the_configuration_of_iptables_persistent_on_debian.html

---------------------------------------


=======================================

            PDNSD  pdnsd

=======================================

sudo ls -l /var/cache/pdnsd/pdnsd.cache

Для интереса можно время от времени проверять размер кэша (/var/cache/pdnsd/pdnsd.cache).
С каждым днем использования он должен становиться все больше и больше.

sudo pdnsd-ctl status

Просмотр текущих загруженных настроек.

http://habrahabr.ru/post/159013/
http://lapitoop.ru/full-faq-pdnsd/
https://wiki.archlinux.org/index.php/Pdnsd
http://www.opennet.ru/man.shtml?topic=pdnsd.conf&category=5&russian=0

pdnsd-ctl record test.net delete

========================================

              Rage 4

========================================

curl "https://secure.rage4.com/secure/webhook/?key=0e11a932431ded4e28c545748f02422e&status=0" >/dev/null 2>&1


*/5 * * * * /usr/local/custom/rage4.sh >/dev/null 2>&1

----------------------------------------


========================================

            запуск  nohup

========================================

nohup ./checker.sh >/dev/null 2>&1 &

параметры

>/dev/null - без вывода
& - переводит процес в фоновый режим



========================================

             chmod   папки

========================================

cd /home/some_dir
Заходим в целевую директорию

chmod -R 644 *
Массово устанавливаем chmod 644 на всё

find . -type d -exec chmod 0755 {} ';'

----------------------------------------


========================================

            ArchiveTeam

========================================

Wretch LH1 RU2 UA1 GCE US4 US6 NLx2 NL2 CZ 

adduser --system --group --shell /bin/bash archiveteam

apt-get install -y git-core libgnutls-dev lua5.1 liblua5.1-0 liblua5.1-0-dev screen python-dev python-pip bzip2 zlib1g-dev

pip install seesaw

su -c "cd /home/archiveteam; git clone https://github.com/ArchiveTeam/wretch-grab.git; cd wretch-grab; ./get-wget-lua.sh" archiveteam

screen -S WRETCH su -c "cd /home/archiveteam/wretch-grab/; run-pipeline pipeline.py --concurrent 2 --disable-web-server inglar" archiveteam


---------------------
ctrl+A D to detach
---------------------

несколько IP адресов

run-pipeline pipeline.py --concurrent 2 inglar --disable-web-server --context-value bind_address=123.4.5.6

screen su -c "cd /home/archiveteam/wretch-grab/; run-pipeline pipeline.py --concurrent 2 --disable-web-server inglar --context-value bind_address=0.0.0.0" archiveteam

--------------------


удаление

------------------

userdel -r archiveteam
pip uninstall -y seesaw tornado simplejson tornadio2 ordereddict
apt-get purge -y git-core libgnutls-dev lua5.1 liblua5.1-0 liblua5.1-0-dev python-dev python-pip bzip2 zlib1g-dev
apt-get -y autoremove

=============================

         screen

=============================
https://wiki.archlinux.org/index.php/GNU_Screen_%28%D0%A0%D1%83%D1%81%D1%81%D0%BA%D0%B8%D0%B9%29

screen -d
screen -r


=============================


       pptp client

=============================

pon <vpn_name> debug dump logfd 2 nodetach

pon us1 debug dump logfd 2 nodetach

route add default dev ppp0


============================
      
        opvenvpn

============================

ca /etc/openvpn/ca.crt


cp /root/ca.crt /etc/openvpn/ca.crt


echo "ca /etc/openvpn/ca.crt" >> /<file_name>


openvpn --config 

openvpn --auth-user-pass --config 


screen su -c "openvpn --config uk.ovpn" root




cd ~/.vpn/


LH1 - vpn.sh us_dallas_tcp
LH2 - vpngate_se_94.255.136.249_tcp_995.ovpn
LH3 - vpn.sh ch_tcp
LH4 - vpngate_jp_116.94.157.229_tcp_1610.ovpn


UA2
LH1 - vpn.sh uk2_tcp
LH2 - vpngate_se_81.226.4.75_tcp_995.ovpn
LH3 - vpngate_us_mo_23.255.132.219_tcp_995.ovpn


============================================

           virtualbox

============================================

apt-get install linux-headers-$(uname -r)

--------------------------------------------

============================================

              minstall

============================================

https://github.com/KnightSwarm/Minstall

wget --no-check-certificate -O minstall.tar.gz http://www.github.com/KnightSwarm/Minstall/archive/2.5.7.tar.gz; tar zxvf minstall.tar.gz; rm minstall.tar.gz; cd Minstall-2.5.7


============================================

              VestaCP

============================================

https://forum.vestacp.com/viewtopic.php?f=13&t=3750

https://forum.vestacp.com/viewtopic.php?f=43&t=3541&start=120

DNS

https://forum.vestacp.com/viewtopic.php?f=13&t=3750

adduser --system --group --shell /bin/bash dns-cluster

v-add-remote-dns-host ns.domain.com 8083 admin pass



# Connect to your server as root via SSH
ssh root@your.server

# Download installation script
curl -O http://vestacp.com/pub/vst-install.sh

wget http://vestacp.com/pub/vst-install.sh

# Run it
bash vst-install.sh


для установки на сервер с 128Mb памяти:

vst-install-debian.sh

изменить блок

# Check server type


E: Существуют проблемы, а параметр -y указан без --force-yes

искать строку

apt-get -y install $software

заменить на 

apt-get --force-yes install $software


======================================

wget http://git.io/vpn --no-check-certificate -O openvpn-install.sh; chmod +x openvpn-install.sh; ./openvpn-install.sh

======================================


[===================================]

       resolv.conf OpenVZ

[===================================]


edit /etc/resolv.conf

add these lines:
nameserver 8.8.8.8
nameserver 8.8.4.4

close the file. Run this command:

chattr +i /etc/resolv.conf

then run:

service network restart


[===================================]

            iptables

[===================================]

iptables -L -n -v --line-numbers


The actual iptables rules are created and customized on the command line with the command iptables for IPv4 and ip6tables for IPv6.

These can be saved in a file with the command iptables-save for IPv4.

Debian/Ubuntu: iptables-save > /etc/iptables/rules.v4
RHEL/CentOS: iptables-save > /etc/sysconfig/iptables

These files can be loaded again with the command iptables-restore for IPv4.

Debian/Ubuntu: iptables-restore < /etc/iptables/rules.v4
RHEL/CentOS: iptables-restore < /etc/sysconfig/iptables

If you would also like to use IPv6 rules, these can be stored in a separate file.

Debian/Ubuntu: iptables-save > /etc/iptables/rules.v6
RHEL/CentOS: iptables-save > /etc/sysconfig/ip6tables


Since Ubuntu 10.04 LTS (Lucid) and Debian 6.0 (Squeeze) there is a package with the name "iptables-persistent" which takes over the automatic loading of the saved iptables rules. To do this, the rules must be saved in the file /etc/iptables/rules.v4 for IPv4 and /etc/iptables/rules.v6 for IPv6.

For use, the package must simply be installed.

apt-get install iptables-persistent


------------------------

Set to default

iptables -P INPUT ACCEPT
iptables -P FORWARD ACCEPT
iptables -P OUTPUT ACCEPT
iptables -F
iptables -X

-----------------------------------------------------

https://blog.ls20.com/securing-your-asterisk-voip-server-with-iptables/


Set default policies:

nano /etc/iptables/rules.v4
*filter
:INPUT ACCEPT [0:0]
:FORWARD DROP [0:0]
:OUTPUT ACCEPT [0:0]
:ICMPALL - [0:0]
:IPSPF - [0:0]
:ASIP - [0:0]
:DPTS - [0:0]
:RLMSET - [0:0]
:ZREJ - [0:0]
COMMIT

-----------------------------------------------------

The INPUT chain. replace YOUR_SSH_PORT with the port you chose:

iptables -A INPUT -m conntrack --ctstate INVALID -j DROP
iptables -A INPUT -m conntrack --ctstate RELATED,ESTABLISHED -j ACCEPT
iptables -A INPUT -i lo -j ACCEPT
iptables -A INPUT -m recent --rcheck --name RLM --seconds 600 --hitcount 1 -j DROP
iptables -A INPUT -p icmp --icmp-type 255 -j ICMPALL
iptables -A INPUT -i eth+ -j IPSPF
iptables -A INPUT -p tcp --dport 77 -j ACCEPT
iptables -A INPUT -j ASIP
iptables -A INPUT -j DPTS
iptables -A INPUT -m limit --limit 10/min -j LOG
iptables -A INPUT -j ZREJ

-----------------------------------------------------

The ICMPALL chain:

iptables -A ICMPALL -p icmp --fragment -j DROP           
iptables -A ICMPALL -p icmp --icmp-type 0 -j ACCEPT
iptables -A ICMPALL -p icmp --icmp-type 3 -j ACCEPT
iptables -A ICMPALL -p icmp --icmp-type 4 -j ACCEPT
iptables -A ICMPALL -p icmp --icmp-type 8 -j ACCEPT
iptables -A ICMPALL -p icmp --icmp-type 11 -j ACCEPT
iptables -A ICMPALL -j DROP

Here, we only allow ICMP types that are commonly used and relatively safe, while blocking the rest.

-----------------------------------------------------

The IPSPF chain:

==========================

   iptables ssh

==========================

ограничить подключение подсетью

iptables -A INPUT -s 10.0.0.0/20 -i eth0 -p tcp --dport 22 -m state --state NEW,ESTABLISHED -j ACCEPT


==========================

   просмотр syslog

==========================

интерактивный  вывод

tail /var/log/syslog -f | grep "127.0.0.1"


для  Shorewall

*локальный IP адрес 

tail /var/log/syslog -f | grep "DST=192.168.1.1"

*удалённый IP адрес 109.207.123.5

tail /var/log/syslog -f | grep "DST=192.168.1.1"

*локальный порт 22

tail /var/log/syslog -f | grep "DPT=22"

*удалённый порт 80

tail /var/log/syslog -f | grep "SPT=22"

==========================

      shorewall

==========================

показать  правила  цепочки:

shorewall show net2fw


==========================

 StatusCake & firewall

==========================

What Test Locations Do You Have?

http://kb.statuscake.com/what-test-locations-do-you-have/

-----------

If you need to keep your firewall up to date

https://www.facebook.com/statuscake/posts/328548963920829

https://www.statuscake.com/API/Locations/txt

===========================
  mz - packet generator
===========================

 mz - a fast versatile packet generator

===========================
        backups
===========================

/etc/webmin/mysql/backup.pl --all
/home/vis/backups/scripts/bckp_create > /dev/null 2>&1
lftp -f /home/vis/backups/scripts/bckp_transfer > /dev/null 2>&1

---------------------------

===========================
        apache2
Could not reliably determine
===========================

echo "ServerName localhost" >> /etc/apache2/apache2.conf

---------------------------

===========================
 megatool  for  mega.co.nz
===========================

http://albertolarripa.com/2013/07/10/megatools-synchronizing-your-backups-to-mega/

---------------------------

===========================
  список  файлов, которые
   принадлежат пакету
===========================
 dpkg -L package

---------------------------

===========================
The certificate of «raw.github.com» is not trusted.
===========================

apt-get install ca-certificates

---------------------------

===========================
    nano & numpad
===========================
nano /etc/nanorc

# uncomment/comment
set rebindkeypad

*Interpret the numeric keypad keys so that they all work properly.
---------------------------

===========================
       locale
===========================
* view current locale
locale

*issue:
LANG=
LC_CTYPE=«POSIX»
....

*solution
echo "export LC_ALL=ru_RU.UTF-8" >> ~/.bashrc

nano ~/.bashrc
export LC_ALL=ru_RU.UTF-8
---------------------------

===========================
 показать содержимое файла
===========================

cat /etc/vsftpd.conf | grep -v ^#

---------------------------

===========================
   Iceweasel Profiles
===========================
создать  ярлык с параметрами

iceweasel -no-remote -ProfileManager
---------------------------

===========================
        synaptic
===========================

команда  запуска  для  пользователя,
елси  не  работает  ярлык  на рабочем столе:

/usr/sbin/synaptic

еще  менеджер пакетов

apt-get install gdebi

---------------------------
===========================
   очистка кэша шрифтов   
    clear font cache
===========================

fc-cache -rv

GNOME Tweak Tool — Настройка Ubuntu Linux
имеет  функцию настройки шрифтов

apt-get install gnome-tweak-tool

вызов командой:

gnome-tweak-tool
---------------------------

===========================
     gtk-engine
===========================
установка  gtk-engines  и
Murrine Engine 

apt-get install gtk2-engines
apt-get install gtk2-engines-murrine

===========================
    Digitalocean SWAP
===========================
http://bit.ly/P79wAg

*check if any swap files have been enabled on the VPS
swapon -s

*create the swap file itself using the dd command :
sudo dd if=/dev/zero of=/swapfile bs=1024 count=256k

*prepare the swap file by creating a linux swap area:
mkswap /swapfile

*activating the swap file:
swapon /swapfile

*adding SWAP it to the fstab file.
nano /etc/fstab

 paste in the following line:
/swapfile       none    swap    sw      0       0 

*swappiness in the file should be set to 10.
Skipping this step may cause both poor performance,
whereas setting it to 10 will cause swap to act as
an emergency buffer, preventing out-of-memory crashes.

You can do this with the following commands:

echo 10 | sudo tee /proc/sys/vm/swappiness
echo vm.swappiness = 10 | sudo tee -a /etc/sysctl.conf

*To prevent the file from being world-readable,
you should set up the correct permissions on the swap file: 

chown root:root /swapfile
chmod 0600 /swapfile

===========================
         ioping
===========================

 wget https://ioping.googlecode.com/files/ioping-0.8.tar.gz
 tar zxvf ioping-0.8.tar.gz
 cd ioping-0.8
 make
 make install
 
 если  надо,  то доустановить:
 
 apt-get install g++

использование

ioping /dev/vda6 -c 10 

доп.информация:

http://code.google.com/p/ioping/

Как правильно мерять производительность диска

http://habrahabr.ru/post/154235/


#################################

http://j.mp/debtips

#################################

===========================
    ipv6 tunnelbroker
===========================

auto ipv6
iface ipv6 inet6 v4tunnel
address 2001:470:35:533::2
netmask 64
endpoint 216.218.221.42
local 103.236.148.65
gateway 2001:470:35:533::1
ttl 255

up ip -6 route add 2001:470:36:533::/64 dev ipv6
down ip -6 route del 2001:470:36:533::/64 dev ipv6

up ip -6 addr add 2001:470:36:533::1/64 dev ipv6
down ip -6 addr add 2001:470:36:533::1/64 dev ipv6
up ip -6 addr add 2001:470:36:533::123/64 dev ipv6
down ip -6 addr add 2001:470:36:533::123/64 dev ipv6

==========================
          GCE
==========================
apt update && apt install -y htop vnstat screen mc masscan && mkdir ~/.ssh && wget http://xsrv.tk/files/conf/authorized_keys -O ~/.ssh/authorized_keys && chmod 700 ~/.ssh && chmod 600 ~/.ssh/authorized_keys && rm /etc/pam.d/sshd && wget http://xsrv.tk/files/conf/sshd -O /etc/pam.d/sshd && rm /etc/ssh/sshd_config && wget http://xsrv.tk/files/conf/sshd_config -O /etc/ssh/sshd_config && service ssh restart && mkdir ~/.config/ && mkdir ~/.config/mc && wget http://xsrv.tk/files/conf/ini -O ~/.config/mc/ini

--------------------------
